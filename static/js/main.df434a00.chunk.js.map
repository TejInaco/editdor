{"version":3,"sources":["assets/editdor.png","assets/WoT.png","context/ediTDorContext.js","util.js","components/Dialogs/DialogTemplate.jsx","components/Dialogs/AddFormDialog.jsx","components/Dialogs/AddLinkTdDialog.jsx","components/InfoIcon/InfoIcon.jsx","components/InfoIcon/InfoTooltips.jsx","components/TDViewer/Form.jsx","components/TDViewer/Link.jsx","components/Dialogs/DialogComponents.jsx","components/Dialogs/AddActionDialog.jsx","components/Dialogs/AddEventDialog.jsx","components/Dialogs/AddPropertyDialog.jsx","components/TDViewer/Action.jsx","components/TDViewer/Event.jsx","components/TDViewer/Property.jsx","components/TDViewer/SearchBar.jsx","components/TDViewer/InteractionSection.jsx","components/TDViewer/RenderedObject.jsx","components/TDViewer/TDViewer.jsx","components/Editor/Editor.jsx","components/App/AppHeader/Button.jsx","components/Dialogs/ShareDialog.jsx","components/Dialogs/ConvertTmDialog.jsx","components/Dialogs/CreateTdDialog.jsx","components/App/AppHeader/AppHeader.jsx","components/App/AppFooter.jsx","context/editorReducers.js","context/GlobalState.js","components/App/App.jsx","serviceWorker.js","index.js"],"names":["module","exports","React","createContext","offlineTD","theme","isModified","isThingModel","undefined","name","fileHandle","showConvertBtn","linkedTd","updateOfflineTD","td","updateIsModified","updateIsThingModel","setFileHandle","handle","removeForm","form","addForm","removeLink","link","addActionForm","params","addEventForm","removeOneOfAKindReducer","kind","oneOfAKind","updateShowConvertBtn","addLinkedTd","updateLinkedTd","buildAttributeListObject","firstAttribute","object","dontRender","attributeListObject","Object","entries","key","value","includes","separateForms","forms","newForms","i","length","Array","isArray","op","temp","push","hasForms","itemToCheck","hasLinks","links","checkIfFormIsInElement","element","deepCompare","y","changeBetweenTd","context","href","a","createWritable","writable","write","close","console","error","message","getFile","file","JSON","text","parse","offlineTd","stringify","document","getElementById","keys","getFileHandle","window","showOpenFilePicker","types","description","accept","then","handles","chooseFileSystemEntries","getFileHTML5","Promise","resolve","reject","fileInput","onchange","e","files","Error","click","_readFileHTML5","reader","FileReader","addEventListener","event","srcElement","result","readAsText","getDirectedValue","source","atContext","direction","lang","TABLE","ar","fa","ps","ur","hy","as","bn","zb","ab","be","bg","kk","mk","ru","uk","hi","mr","ne","ko","ma","am","ti","ka","el","gu","pa","he","iw","yi","ja","km","kn","lo","af","ay","bs","ca","ch","cs","cy","da","de","en","eo","es","et","eu","fi","fj","fo","fr","fy","ga","gl","gn","gv","hr","ht","hu","id","in","is","it","kl","la","lb","ln","lt","lv","mg","mh","mo","ms","mt","na","nb","nd","nl","nn","no","nr","ny","om","pl","pt","qu","rm","rn","ro","rw","sg","sk","sl","sm","so","sq","ss","st","sv","sw","tl","tn","to","tr","ts","ve","vi","xh","zu","ds","gs","hs","me","ni","ns","te","tk","tm","tp","tv","ml","my","nq","or","si","ta","dv","th","dz","getDirectionSymbol","dir","test","toString","getDirection","split","toLowerCase","forEach","DialogTemplate","props","title","children","cancelText","onCancel","submitText","onSubmit","hasSubmit","keysDown","onkeydown","onkeyup","className","onClick","AddFormDialog","forwardRef","ref","useContext","ediTDorContext","useState","display","setDisplay","type","toUpperCase","slice","interaction","interactionName","useEffect","useImperativeHandle","openModal","open","checkIfFormExists","x","checkIfFormIsInItem","formSelection","operationsSelections","htmlFor","placeholder","onChange","clearErrorMessage","ReactDOM","createPortal","operations","map","checked","filter","trim","showErrorMessage","propName","actionName","eventName","_","addFormToInteraction","msg","textContent","classList","remove","add","formCheckbox","readOnly","tdJSON","oldtdJSON","AddLinkTdDialog","linkingMethod","setlinkingMethod","currentLinkedTd","setCurrentLinkedTd","checkIfLinkExists","checkIfLinkIsInItem","hasNativeFS","useCallback","linkingMethodChange","linkingOption","read","openFile","alert","RelationType","index","currentRelation","list","disabled","style","marginLeft","clearHrefErrorMessage","rel","isValidUrl","url","URL","protocol","httpRequest","XMLHttpRequest","send","getResponseHeader","thingDescription","response","parsedTd","ex","showHrefErrorMessage","addLinksToTd","InfoIconWrapper","tooltip","html","InfoIcon","color","size","data-html","data-type","data-tip","data-background-color","TooltipContent","this","getFormsTooltipContent","getLinksTooltipContent","tooltipMapper","Form","formChooser","ObserveForm","UnobserveForm","ObserveAllForm","UnobserveAllForm","ReadForm","ReadMultipleForm","formIndex","ReadAllForm","WriteForm","WriteMultipleForm","WriteAllForm","InvokeForm","interactionType","UndefinedForm","Link","infoLink","deleteLink","DialogTextField","label","autoFocus","DialogTextArea","rows","DialogDropdown","options","DialogCheckbox","AddActionDialog","addActionToTd","action","onAddAction","AddEventDialog","addEventToTd","onAddEvent","NO_TYPE","AddPropertyDialog","addPropertyToTd","property","observable","dataType","items","properties","onAddProperty","alreadyRenderedKeys","Action","addFormDialog","useRef","constructor","attributes","current","Event","Property","prop","SearchBar","autoComplete","onKeyUp","aria-label","ariaLabel","SORT_ASC","oldTd","InteractionSection","setFilter","sortOrder","setSortOrder","addInteractionDialog","buildChildren","filteredInteractions","filtered","indexOf","applyFilter","actions","events","createPropertyDialog","target","ordered","toSort","sort","b","nameA","nameB","localeCompare","sortedObject","reverse","sortKeysInObject","xmlns","width","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","d","RenderedObject","showChildren","setShowChildren","handleClick","val","k","v","indicator","i1","k1","v1","m1","TDViewer","metaData","addLinkDialog","graphHeight","setGraphHeight","representationFormat","setRepresentationFormat","isLinksOpen","setIsLinksOpen","representationFormatChange","getElementsByTagName","evt","posx","posy","graphTd","joint","Graph","paperTd","Paper","model","gridSize","drawGrid","restrictTranslate","currentTdModel","standard","Rectangle","position","resize","attr","body","set","attrs","addCell","targetTdModel","removeButton","Remove","useModelGeometry","elementView","buttonView","get","toolsView","ToolsView","tools","findView","addTools","infoButton","Button","markup","tagName","selector","rotate","line","labels","addTo","mapping","require","tdSchema","tmSchema","editorOptions","selectOnLineNumbers","automaticLayout","lineDecorationsWidth","JSONEditorComponent","schemas","proxy","setProxy","editorInstance","tabs","setTabs","editorWillMount","monaco","languages","json","jsonDefaults","setDiagnosticsOptions","validate","enableSchemaRequest","warn","Proxy","jsonSchemaObjects","fileMatch","uri","addSchema","removeSchema","splice","fetchSchema","fetch","res","schema","editorText","state","atType","log","contextKey","find","err","getTabs","changeLinkedTd","language","editorDidMount","editor","onDidChangeModelDecorations","getModel","getModeId","ShareDialog","copyLinkToClipboard","createPermalink","focusPermalinkField","urlField","createPermalinkField","parsedTD","location","origin","pathname","encodeURIComponent","defaultValue","hasFocus","navigator","clipboard","writeText","setTimeout","select","ConvertTmDialog","htmlInputs","setHtmlInputs","createHtmlInputs","convertTmToTd","regex","startIindices","exec","endIndices","placeholders","Set","holder","htmlProperties","htmlActions","htmlEvents","createAffordanceHtml","affName","affContainer","aff","required","requiredFields","defaultChecked","data-interaction","parsed","field","startsWith","ignored","divider","mappingObject","item","elem","join","newProperties","reduce","obj","newActions","newEvents","permalink","CreateTdDialog","setType","content","buildForm","createNewTD","changeType","getType","formField","base","tdDescription","tdSecurity","thing","securityDefinitions","scheme","AppHeader","verifyDiscard","confirm","readFile","writeFile","contents","createWriter","writer","saveAsHTML5","filename","tdTitle","aDownload","replace","File","createObjectURL","setAttribute","saveFileAs","getNewFileHandle","saveFile","opts","showSaveFilePicker","accepts","extensions","mimeTypes","search","searchParams","shortcutHandler","platform","match","metaKey","ctrlKey","preventDefault","stopPropagation","openCreateTdDialog","onbeforeunload","returnValue","removeEventListener","convertTmDialog","shareDialog","createTdDialog","src","wot","alt","logo","AppFooter","bytes","megaBytes","propertiesCount","actionsCount","eventsCount","TextEncoder","encode","toFixed","process","UPDATE_OFFLINE_TD","UPDATE_IS_MODFIED","UPDATE_IS_THINGMODEL","SET_FILE_HANDLE","REMOVE_FORM_FROM_TD","REMOVE_LINK_FROM_TD","ADD_PROPERTYFORM_TO_TD","ADD_ACTIONFORM_TO_TD","ADD_EVENTFORM_TO_TD","REMOVE_ONE_OF_A_KIND_FROM_TD","UPDATE_SHOW_CONVERT_BTN","ADD_LINKED_TD","UPDATE_LINKED_TD","editdorReducer","updateOfflineTDReducer","updateFileHandleReducer","removeFormReducer","removeLinkReducer","oneOfAKindName","addPropertyFormReducer","addActionFormReducer","addEventFormReducer","resultingLinkedTd","assign","GlobalState","useReducer","editdorState","dispatch","Provider","dragElement","md","first","second","onMouseMove","delta","clientX","clientY","Math","min","max","firstWidth","secondWidth","left","offsetLeft","onmousedown","offsetTop","offsetWidth","onmousemove","onmouseup","App","isLocalhost","Boolean","hostname","registerValidSW","swUrl","config","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","catch","patch","render","StrictMode","headers","contentType","status","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.df434a00.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/editdor.6cac600d.png\";","module.exports = __webpack_public_path__ + \"static/media/WoT.89768410.png\";","/********************************************************************************\n * Copyright (c) 2018 - 2020 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React from 'react';\n\nexport default React.createContext({\n  offlineTD: '',\n  theme: 'dark',\n  isModified: false,\n  isThingModel: undefined,\n  name: '',\n  fileHandle:'',\n  showConvertBtn: false,\n  linkedTd:{},\n  updateOfflineTD: td => {},\n  updateIsModified: isModified => {},\n  updateIsThingModel: isThingModel => {},\n  setFileHandle: handle => {},\n  removeForm: form => {},\n  addForm: form => {},\n  removeLink: link => {},\n  addActionForm: params => {},\n  addEventForm: params => {},\n  removeOneOfAKindReducer: (kind, oneOfAKind) => {},\n  updateShowConvertBtn: showConvertBtn => {},\n  addLinkedTd: linkedTd => {},\n  updateLinkedTd: linkedTd => {}\n});","/********************************************************************************\n * Copyright (c) 2018 - 2020 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\n/**\n * \n * @param {*} firstAttribute \n * @param {*} object \n * @param {*} dontRender is a list of keys that shouldn't be packed into the attribute list.\n * \n * @description\n * Parses all key-value pairs of an object into an object'. \n * \n */\nexport const buildAttributeListObject = (firstAttribute, object, dontRender) => {\n    let attributeListObject = { ...firstAttribute }\n\n    for (const [key, value] of Object.entries(object)) {\n        if (!dontRender.includes(key)) {\n            attributeListObject[key] = value\n        }\n    }\n\n    return attributeListObject;\n}\n\n/**\n * \n * @param {*} forms \n * \n * @description\n * Converts Forms that have an array as the \"op\" value into multiple separate Forms \n * which only have a string as \"op\" value.\n */\nexport const separateForms = (forms) => {\n    if (forms === undefined && !forms) {\n        return []\n    }\n\n    const newForms = [];\n\n    for (let i = 0; i < forms.length; i++) {\n        const form = forms[i];\n\n        if (!Array.isArray(form.op)) {\n            newForms.push(form);\n            continue;\n        }\n\n        for (let i = 0; i < form.op.length; i++) {\n            const temp = { ...form };\n            temp.op = form.op[i];\n            newForms.push(temp);\n        }\n    }\n\n    return newForms;\n}\n\n\n\n\n/**\n * \n * @param {itemToCheck} itemToCheck \n * \n * Checks if item contains Forms\n * \n */\nexport const hasForms = (itemToCheck) => {\n    return itemToCheck.forms ? true : false;\n}\n\n/**   \n  *Check if link exists in the links section of iteamToCheck  \n*/\nexport const hasLinks = (itemToCheck) => {\n    return itemToCheck.links ? true : false;\n}\n\n/**  \n  *Check if link exists in the links section of iteamToCheck \n*/\nexport const checkIfLinkIsInItem = (link, itemToCheck) => {\n    for (const element of itemToCheck.links) {\n        if (element.href === link.href) {\n            return true;\n        }\n    }\n    return false;\n\n}\nexport const checkIfFormIsInItem = (form, itemToCheck) => {\n    for (const element of itemToCheck.forms) {\n        if (typeof (form.op) === \"string\") {\n            return checkIfFormIsInElement(form, element)\n        } else {\n            for (const x of form.op) {\n                if (typeof (element.op) === 'string') {\n                    if (element.op === x) {\n                        return true;\n                    }\n                } else {\n                    if (element.op.includes(x)) {\n                        let deepCompare = true;\n                        for (const y in form) {\n                            if (y !== 'op') {\n                                if (element[y] !== form[y]) {\n                                    deepCompare = false;\n                                }\n                            }\n                        }\n                        if (deepCompare)\n                            return true\n                    }\n                }\n            }\n        }\n    }\n    return false\n}\n\nconst checkIfFormIsInElement = (form, element) => {\n    if (typeof (element.op) === 'string') {\n        if (element.op === form.op) {\n            return true;\n        }\n    } else {\n        if (element.op.includes(form.op)) {\n            let deepCompare = true;\n            for (const y in form) {\n                if (y !== 'op') {\n                    if (element[y] !== form[y]) {\n                        deepCompare = false;\n                    }\n                }\n            }\n            if (deepCompare)\n                return true\n        }\n    }\n}\n\n/**\n    * Display the selected Thing description \n    * Save the current Thing Description if wanted\n    * Method supports both fileHandler and jsonld file\n*/\nexport const changeBetweenTd = async (context, href) => {\n    var writable\n    if (context.linkedTd[href][\"kind\"] === \"file\") {\n        try {\n            if (context.isModified && context.fileHandle) {\n                writable = await context.fileHandle.createWritable();\n                await writable.write(context.offlineTD);\n                await writable.close();\n            }\n        } catch (e) {\n            console.error(e.message);\n        }\n        let fileHandle = context.linkedTd[href];\n        const file = await fileHandle.getFile();\n        const td = JSON.parse(await file.text());\n        let offlineTd = JSON.stringify(td, null, 2);\n        context.setFileHandle(fileHandle);\n        context.updateOfflineTD(offlineTd);\n        context.updateIsModified(false);\n        document.getElementById(\"linkedTd\").value = href;\n    }\n    // If we create a TD using the New button then we don't have a file handler\n    // In that case the entry in linkedTd is not a file handler but a Thing Description Json \n    else if (Object.keys(context.linkedTd[href]).length) {\n        try {\n            if (context.isModified && context.fileHandle) {\n                writable = await context.fileHandle.createWritable();\n                await writable.write(context.offlineTD);\n                await writable.close();\n            }\n        } catch (e) {\n            console.error(e.message);\n        }\n        context.setFileHandle(undefined);\n        const td = context.linkedTd[href];\n        let offlineTd = JSON.stringify(td, null, 2);\n        context.updateOfflineTD(offlineTd);\n        context.updateIsModified(false);\n        document.getElementById(\"linkedTd\").value = href;\n\n    }\n}\n\n/**\n   * File Handle from native filesystem api\n   * Only JSON/JSON+LD Files are supported\n*/\nexport const getFileHandle = () => {\n    const opts = {\n        types: [\n            {\n                description: \"Thing Description\",\n                accept: { \"application/ld+json\": [\".jsonld\", \".json\"] },\n            },\n        ],\n    };\n    if (\"showOpenFilePicker\" in window) {\n        return window.showOpenFilePicker(opts).then((handles) => handles[0]);\n    }\n    return window.chooseFileSystemEntries();\n};\n\n/**\n   * Reading files with HTML5 input\n*/\nexport const getFileHTML5 = async () => {\n    return new Promise((resolve, reject) => {\n        const fileInput = document.getElementById(\"fileInput\");\n        fileInput.onchange = (e) => {\n            const file = fileInput.files[0];\n            if (file) {\n                return resolve(file);\n            }\n            return reject(new Error(\"AbortError\"));\n        };\n        fileInput.click();\n    });\n};\n\nexport const _readFileHTML5 = (file) => {\n    return new Promise((resolve) => {\n        const reader = new FileReader();\n        reader.addEventListener(\"loadend\", (event) => {\n            const text = event.srcElement.result;\n            return resolve(text);\n        });\n        reader.readAsText(file);\n    });\n}\n\n/**\n * @param {*} source Source object\n * @param {string} key Source key\n * @param {*} atContext Respective @context value\n * \n * @returns {string} String value of source[key] with prepended LRI or RLI symbol\n *\n * @description\n * Returns the value of source[key] with the direction information (rtl/ltr).\n */\nexport const getDirectedValue = (source, key, atContext) => {\n    const LRI = '\\u2066';\n    const RLI = '\\u2067';\n    const TABLE = {\n      ar: 'rtl',\n      fa: 'rtl',\n      ps: 'rtl',\n      ur: 'rtl',\n      hy: 'ltr',\n      as: 'ltr',\n      bn: 'ltr',\n      zb: 'ltr',\n      ab: 'ltr',\n      be: 'ltr',\n      bg: 'ltr',\n      kk: 'ltr',\n      mk: 'ltr',\n      ru: 'ltr',\n      uk: 'ltr',\n      hi: 'ltr',\n      mr: 'ltr',\n      ne: 'ltr',\n      ko: 'ltr',\n      ma: 'ltr',\n      am: 'ltr',\n      ti: 'ltr',\n      ka: 'ltr',\n      el: 'ltr',\n      gu: 'ltr',\n      pa: 'ltr',\n      he: 'rtl',\n      iw: 'rtl',\n      yi: 'rtl',\n      ja: 'ltr',\n      km: 'ltr',\n      kn: 'ltr',\n      lo: 'ltr',\n      af: 'ltr',\n      ay: 'ltr',\n      bs: 'ltr',\n      ca: 'ltr',\n      ch: 'ltr',\n      cs: 'ltr',\n      cy: 'ltr',\n      da: 'ltr',\n      de: 'ltr',\n      en: 'ltr',\n      eo: 'ltr',\n      es: 'ltr',\n      et: 'ltr',\n      eu: 'ltr',\n      fi: 'ltr',\n      fj: 'ltr',\n      fo: 'ltr',\n      fr: 'ltr',\n      fy: 'ltr',\n      ga: 'ltr',\n      gl: 'ltr',\n      gn: 'ltr',\n      gv: 'ltr',\n      hr: 'ltr',\n      ht: 'ltr',\n      hu: 'ltr',\n      id: 'ltr',\n      in: 'ltr',\n      is: 'ltr',\n      it: 'ltr',\n      kl: 'ltr',\n      la: 'ltr',\n      lb: 'ltr',\n      ln: 'ltr',\n      lt: 'ltr',\n      lv: 'ltr',\n      mg: 'ltr',\n      mh: 'ltr',\n      mo: 'ltr',\n      ms: 'ltr',\n      mt: 'ltr',\n      na: 'ltr',\n      nb: 'ltr',\n      nd: 'ltr',\n      nl: 'ltr',\n      nn: 'ltr',\n      no: 'ltr',\n      nr: 'ltr',\n      ny: 'ltr',\n      om: 'ltr',\n      pl: 'ltr',\n      pt: 'ltr',\n      qu: 'ltr',\n      rm: 'ltr',\n      rn: 'ltr',\n      ro: 'ltr',\n      rw: 'ltr',\n      sg: 'ltr',\n      sk: 'ltr',\n      sl: 'ltr',\n      sm: 'ltr',\n      so: 'ltr',\n      sq: 'ltr',\n      ss: 'ltr',\n      st: 'ltr',\n      sv: 'ltr',\n      sw: 'ltr',\n      tl: 'ltr',\n      tn: 'ltr',\n      to: 'ltr',\n      tr: 'ltr',\n      ts: 'ltr',\n      ve: 'ltr',\n      vi: 'ltr',\n      xh: 'ltr',\n      zu: 'ltr',\n      ds: 'ltr',\n      gs: 'ltr',\n      hs: 'ltr',\n      me: 'ltr',\n      ni: 'ltr',\n      ns: 'ltr',\n      te: 'ltr',\n      tk: 'ltr',\n      tm: 'ltr',\n      tp: 'ltr',\n      tv: 'ltr',\n      ml: 'ltr',\n      my: 'ltr',\n      nq: 'ltr',\n      or: 'ltr',\n      si: 'ltr',\n      ta: 'ltr',\n      dv: 'rtl',\n      th: 'ltr',\n      dz: 'ltr'\n    };\n\n    const getDirectionSymbol = dir => (dir === 'ltr') ? LRI : RLI;\n\n    // title, description and language tags (like \"en\" or \"en-US\") are treated differently\n    if (!['title', 'description'].includes(key) && !/^[A-Za-z]{2}(-[A-Za-z]{2})?$/.test(key)) {\n      return getDirectionSymbol(source[key].toString().getDirection()) + source[key];\n    }\n\n    if (/^[A-Za-z]{2}(-[A-Za-z]{2})?$/.test(key)) {\n      // Language tags can be compound like ar-EG or en-US, split when needed\n      // Also, we ignore the case for language tags\n      const lookupKey = (key.includes('-')) ? key.split('-')[0] : key.toLowerCase();\n      const dir = TABLE[lookupKey];\n      if (dir) return getDirectionSymbol(dir) + source[key];\n      return getDirectionSymbol('ltr') + source[key];\n    }\n\n    let direction;\n    let lang;\n\n    if (!Array.isArray(atContext)) {\n      atContext = [atContext];\n    }\n\n    atContext.forEach(e => {\n      if (typeof e === 'object') {\n        if (e['@direction']) direction = e['@direction'];\n        if (e['@language']) lang = e['@language'];\n      }\n    });\n\n    if (key === 'title' || key === 'description') {\n      if (direction) return getDirectionSymbol(direction) + source[key];\n      if (lang) {\n        const lookupKey = (lang.includes('-')) ? lang.split('-')[0] : lang.toLowerCase();\n        const dir = TABLE[lookupKey];\n        if (dir) return getDirectionSymbol(dir) + source[key];\n        return getDirectionSymbol('ltr') + source[key];\n      }\n    }\n\n    return getDirectionSymbol(source[key].toString().getDirection()) + source[key];\n}\n","/********************************************************************************\n * Copyright (c) 2018 - 2021 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React from 'react';\n\nexport const DialogTemplate = (props) => {\n    const title = props.title ?? \"Default Title\";\n    const description = props.description ?? \"Default description, please override.\";\n    const children = props.children ?? <></>;\n\n    const cancelText = props.cancelText ?? \"Cancel\";\n    const onCancel = props.onCancel ?? (() => { });\n\n    const submitText = props.submitText ?? \"Submit\";\n    const onSubmit = props.onSubmit ?? (() => { });\n    const hasSubmit=props.hasSubmit ?? true\n    let keysDown = {};\n    window.onkeydown = function (e) {\n        keysDown[e.key] = true;\n        if (keysDown[\"Control\"] && keysDown[\"Enter\"]) {\n            document.getElementById(\"submitButton\").click();\n        }\n    }\n\n    window.onkeyup = function (e) {\n        keysDown[e.key] = false;\n    }\n\n    return (<div className=\"flex bg-gray-400 bg-opacity-50 w-full h-full absolute top-0 left-0 justify-center items-center z-10 text-white\">\n        <div className=\"bg-gray-500 w-1/3 flex flex-col justify-start rounded-xl shadow-xl p-4 max-h-screen\">\n            <div className=\"flex flex-row justify-start items-center  \">\n                <h1 className=\"text-xl font-bold flex-grow pl-2\">{title}</h1>\n            </div>\n            <h2 className=\"text-gray-400 py-2 pl-2\">{description}</h2>\n            <div className=\"overflow-auto p-2\">\n                {children}\n            </div>\n            <div className=\"flex justify-end pt-4 p-2\">\n                <button className=\"text-white bg-gray-500 p-2 mr-1 rounded-md\" onClick={() => { onCancel(); }}>{cancelText}</button>\n                {hasSubmit&& <button id=\"submitButton\" className=\"flex text-white bg-blue-500 p-2 rounded-md\" onClick={() => onSubmit()}>{submitText}</button>}\n            </div>\n        </div>\n    </div>);\n};\n\n","/********************************************************************************\n * Copyright (c) 2018 - 2021 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React, { forwardRef, useContext, useEffect, useImperativeHandle } from 'react';\nimport ReactDOM from \"react-dom\";\nimport ediTDorContext from \"../../context/ediTDorContext\";\nimport { checkIfFormIsInItem, hasForms } from \"../../util.js\";\nimport { DialogTemplate } from \"./DialogTemplate\";\n\nexport const AddFormDialog = forwardRef((props, ref) => {\n    const context = useContext(ediTDorContext);\n    const [display, setDisplay] = React.useState(() => { return false });\n\n    const type = props.type ?? \"\";\n    const name = type && type[0].toUpperCase() + type.slice(1);\n    const interaction = props.interaction ?? {};\n    const interactionName = props.interactionName ?? \"\";\n\n    useEffect(() => {\n    }, [display, context]);\n\n    useImperativeHandle(ref, () => {\n        return {\n            openModal: () => open(),\n            close: () => close()\n        }\n    });\n\n    const open = () => {\n        setDisplay(true)\n    };\n\n    const close = () => {\n        setDisplay(false);\n    };\n\n    const checkIfFormExists = (form) => {\n        if (hasForms(interaction)) {\n            return checkIfFormIsInItem(form, interaction)\n        }\n        return false\n    }\n\n    const addFormToInteraction = (form) => {\n        switch (type) {\n            case 'property':\n                context.addForm({ propName: interactionName, form: form });\n                break;\n            case 'action':\n                context.addActionForm({ actionName: interactionName, form: form });\n                break;\n            case 'event':\n                context.addEventForm({ eventName: interactionName, form: form });\n                break;\n            case 'thing':\n                let td = {}\n                try {\n                    td = JSON.parse(context.offlineTD);\n                } catch (_) { }\n                if (!hasForms(td)) {\n                    td.forms = [];\n                }\n                td.forms.push(form);\n                context.updateOfflineTD(JSON.stringify(td, null, 2))\n                break;\n            default: { }\n        }\n    }\n\n    const formSelection = operationsSelections(type);\n    const children = <>\n        <label className=\"text-sm text-gray-400 font-medium pl-3\">Operations:</label>\n        <div className=\"p-1\">\n            {formSelection}\n        </div>\n        <div className=\"p-1 pt-2\">\n            <label htmlFor=\"form-href\" className=\"text-sm text-gray-400 font-medium pl-2\">Href:</label>\n            <input\n                type=\"text\"\n                name=\"form-href\"\n                id=\"form-href\"\n                className=\"border-gray-600 bg-gray-600 w-full p-2 sm:text-sm border-2 text-white rounded-md focus:outline-none focus:border-blue-500\"\n                placeholder=\"http://example.com/href\"\n                onChange={() => { clearErrorMessage(); }}\n            />\n            <span id=\"form-href-info\" className=\"text-xs text-red-400 pl-2\"></span>\n        </div>\n    </>\n\n    if (display) {\n        return ReactDOM.createPortal(\n            <DialogTemplate\n                onCancel={close}\n                onSubmit={() => {\n                    let form = {};\n                    form.op = operations(type).map(x => {\n                        return document.getElementById('form-' + x).checked ? document.getElementById('form-' + x).value : undefined\n                    }).filter(y => y !== undefined);\n\n                    const href = document.getElementById(\"form-href\").value;\n                    form.href = href !== \"\" ? href.trim() : \"/\";\n\n                    if (form.op.length === 0) {\n                        showErrorMessage(\"You have to select at least one operation ...\");\n                    } else if (checkIfFormExists(form)) {\n                        showErrorMessage(\"A Form for one of the selected operations already exists ...\");\n                    } else {\n                        addFormToInteraction(form);\n                        close();\n                    }\n                }}\n                submitText={\"Add\"}\n                children={children}\n                title={`Add ${name} Form`}\n                description={`Tell us how this ${name} can be interfaced by selecting operations below and providing an href.`}\n            />,\n            document.getElementById(\"modal-root\"));\n    }\n\n    return null;\n});\n\nconst showErrorMessage = (msg) => {\n    document.getElementById(\"form-href-info\").textContent = msg;\n    document.getElementById(\"form-href\").classList.remove(\"border-gray-600\");\n    document.getElementById(\"form-href\").classList.add(\"border-red-400\");\n}\n\nconst clearErrorMessage = () => {\n    document.getElementById(\"form-href\").classList.add(\"border-gray-600\");\n    document.getElementById(\"form-href\").classList.remove(\"border-red-400\");\n}\n\nconst operations = (type) => {\n    switch (type) {\n        case 'property': return [\n            \"writeproperty\",\n            \"readproperty\",\n            \"observeproperty\",\n            \"unobserveproperty\",\n        ];\n        case 'event': return [\n            \"subscribeevent\",\n            \"unsubscribeevent\",\n        ];\n        case 'action': return [\n            \"invokeaction\"\n        ];\n        case 'thing': return [\n            \"writeallproperties\",\n            \"readallproperties\",\n            \"writemultipleproperties\",\n            \"readmultipleproperties\",\n            \"observeallproperties\",\n            \"unobserveallproperties\"\n        ];\n        default: return [];\n    }\n}\n\nconst operationsSelections = (type) => {\n    return <div className=\"bg-gray-600 p-1 rounded-md\">\n        {operations(type).map((e) => formCheckbox(e))}\n    </div>\n};\n\nconst formCheckbox = (name) => {\n    const id = `form-${name}`;\n\n    return <div key={id} className=\"form-checkbox pl-2\">\n        {\n            name !== \"invokeaction\" ? <input id={id}\n                className=\"form-checkbox-input\"\n                type=\"checkbox\"\n                value={name}\n\n            /> : <input id={id}\n                className=\"form-checkbox-input\"\n                type=\"checkbox\"\n                value={name}\n                readOnly={name === 'invokeaction'}\n                checked={name === 'invokeaction'}\n                />\n        }\n        <label className=\"form-checkbox-label pl-2\" htmlFor={id}>{name}</label>\n    </div>;\n}\n","/********************************************************************************\n * Copyright (c) 2018 - 2021 Contributors to the Eclipse Foundation\n *\n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n *\n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React, { forwardRef, useContext, useImperativeHandle, useCallback } from 'react';\nimport ReactDOM from \"react-dom\";\nimport ediTDorContext from \"../../context/ediTDorContext\";\nimport { hasLinks, checkIfLinkIsInItem, getFileHandle, getFileHTML5, _readFileHTML5 } from \"../../util.js\";\nimport { DialogTemplate } from \"./DialogTemplate\";\n\nlet error = \"\";\nlet tdJSON = {};\nlet oldtdJSON = {};\n\nexport const AddLinkTdDialog = forwardRef((props, ref) => {\n  const context = useContext(ediTDorContext);\n  const [display, setDisplay] = React.useState(() => { return false });\n  const [linkingMethod, setlinkingMethod] = React.useState(() => { return \"url\" });\n  const [currentLinkedTd, setCurrentLinkedTd] = React.useState(() => { return {} });\n\n\n  const interaction = props.interaction ?? {};\n  try {\n    oldtdJSON = tdJSON;\n    tdJSON = JSON.parse(context.offlineTD);\n    error = '';\n  } catch (e) {\n    error = e.message;\n    console.error(error);\n    tdJSON = oldtdJSON;\n  }\n\n  useImperativeHandle(ref, () => {\n    return {\n      openModal: () => open(),\n      close: () => close()\n    }\n  });\n\n  const open = () => {\n    setDisplay(true);\n  };\n\n  const close = () => {\n    setDisplay(false);\n  };\n\n\n  const checkIfLinkExists = (link) => {\n    if (hasLinks(interaction)) {\n      return checkIfLinkIsInItem(link, interaction);\n    }\n    return false;\n  }\n\n  const addLinksToTd = (link) => {\n    let td = {};\n    try {\n      td = JSON.parse(context.offlineTD);\n    } catch (_) { }\n    if (!hasLinks(td)) {\n      td.links = [];\n    }\n    td.links.push(link);\n    context.updateOfflineTD(JSON.stringify(td, null, 2));\n  }\n\n  const hasNativeFS = useCallback(() => {\n    return (\n      \"chooseFileSystemEntries\" in window || \"showOpenFilePicker\" in window\n    );\n  }, []);\n\n  const linkingMethodChange = (linkingOption) => {\n    setlinkingMethod(linkingOption);\n    if (currentLinkedTd && linkingOption === 'url') {\n      setCurrentLinkedTd({});\n    }\n  }\n\n  const read = useCallback((file) => {\n    return file.text ? file.text() : _readFileHTML5(file);\n  }, []);\n\n  const openFile = useCallback(\n    async (_) => {\n\n      if (!hasNativeFS()) {\n        const file = await getFileHTML5();\n        if (file) {\n          document.getElementById(\"link-href\").value = \"./\" + file.name;\n          let td = await read(file);\n          setCurrentLinkedTd(JSON.parse(await td));\n        }\n        return;\n      }\n\n      let fileHandle;\n      try {\n        fileHandle = await getFileHandle();\n        const file = await fileHandle.getFile();\n        const href = \"./\" + file.name;\n        setCurrentLinkedTd(fileHandle);\n        document.getElementById(\"link-href\").value = href;\n      } catch (ex) {\n        const msg = \"We ran into an error trying to open your TD.\";\n        console.error(msg, ex);\n        alert(msg);\n      }\n    },\n    [hasNativeFS, read]\n  );\n\n  const RelationType = () => {\n    const relations = [\"icon\", \"service-doc\", \"alternate\", \"type\", \"tm:extends\",\n      \"proxy-to\", \"collection\", \"item\", \"predecessor-version\", \"controlledBy\"];\n    let index = 0;\n    const relationsHtml = relations.map((currentRelation) => {\n      index++;\n      return <option value={currentRelation} key={index} />\n    })\n    return relationsHtml\n  }\n\n  const children = <>\n    <label className=\"text-sm text-gray-400 font-medium pl-3\">Thing Description:</label>\n    <div className=\"p-1\">\n      {tdJSON[\"title\"]}\n    </div>\n    <div className=\"p-1 pt-2\">\n      <label htmlFor=\"rel\" className=\"text-sm text-gray-400 font-medium pl-2\">Relation:(select one of the proposed relations or type your custom relation)</label>\n      <input\n        list=\"relationType\"\n        type=\"text\"\n        name=\"rel\"\n        id=\"rel\"\n        className=\"border-gray-600 bg-gray-600 w-full p-2 sm:text-sm border-2 text-white rounded-md focus:outline-none focus:border-blue-500\"\n        placeholder=\"relation name\"\n      />\n      <datalist id=\"relationType\">\n        <RelationType></RelationType>\n      </datalist>\n\n      <span id=\"link-rel-info\" className=\"text-xs text-red-400 pl-2\"></span>\n    </div>\n    <div className=\"p-1 pt-2\">\n      <label htmlFor=\"link-href\" className=\"text-sm text-gray-400 font-medium pl-2 pr-2\" >Target ressource:</label>\n      <button className=\"text-white font-bold text-sm bg-blue-500 cursor-pointer rounded-md p-2 h-9\" disabled={linkingMethod === 'upload'} onClick={() => { linkingMethodChange(\"upload\"); }}>From local machine</button>\n      <button className=\"text-white font-bold text-sm bg-blue-500 cursor-pointer rounded-md p-2 h-9\" style={{ marginLeft: \"2%\" }} disabled={linkingMethod === 'url'} onClick={() => { linkingMethodChange(\"url\"); }}>Ressource url</button>\n      <div className=\"p-1 pt-4\" >\n        <input\n          type=\"text\"\n          name=\"link-href\"\n          id=\"link-href\"\n          className=\"border-gray-600 bg-gray-600 p-2 sm:text-sm border-2 text-white rounded-md focus:outline-none focus:border-blue-500\"\n          placeholder=\"The target ressource\"\n          onChange={() => { clearHrefErrorMessage(); }}\n          disabled={linkingMethod !== 'url'}\n        />\n        {linkingMethod === 'upload' && <button className=\"text-white bg-blue-500 cursor-pointer rounded-md p-2 h-9\" onClick={openFile} disabled={linkingMethod !== 'upload'} >\n          Open TD\n        </button>}\n      </div>\n      <span id=\"link-href-info\" className=\"text-xs text-red-400 pl-2\"></span>\n      <div>\n        <label htmlFor=\"type\" className=\"text-sm text-gray-400 font-medium pl-2\">Type:(select one of the proposed types or tape your custom type)</label>\n        <input\n          list=\"mediaType\"\n          type=\"text\"\n          name=\"type\"\n          id=\"type\"\n          className=\"border-gray-600 bg-gray-600 w-full p-2 sm:text-sm border-2 text-white rounded-md focus:outline-none focus:border-blue-500\"\n          placeholder=\"media type\"\n        />\n        <datalist id=\"mediaType\">\n          <option value=\"application/td+json\" />\n          <option value=\"image/jpeg\" />\n          <option value=\"text/csv\" />\n          <option value=\"video/mp4\" />\n        </datalist>\n      </div>\n    </div>\n  </>\n  if (display) {\n    return ReactDOM.createPortal(\n      <DialogTemplate\n        onCancel={close}\n        onSubmit={() => {\n          let link = {}\n          let linkedTd = {}\n          const rel = document.getElementById(\"rel\").value;\n          const href = document.getElementById(\"link-href\").value;\n          const type = document.getElementById(\"type\").value;\n          link.href = href !== \"\" ? href.trim() : \"/\";\n          let isValidUrl = true\n          try {\n            var url = new URL(href);\n          } catch (_) {\n            isValidUrl = false;\n          }\n          if (linkingMethod === \"url\" && isValidUrl && (url.protocol === \"http:\" || url.protocol === \"https:\")) {\n            try {\n              var httpRequest = new XMLHttpRequest();\n              httpRequest.open('GET', href, false);\n              httpRequest.send();\n              if (httpRequest.getResponseHeader('content-type').includes(\"application/td+json\")) {\n                const thingDescription = httpRequest.response;\n                let parsedTd = JSON.parse(thingDescription);\n                linkedTd[href] = parsedTd;\n              }\n            } catch (ex) {\n              const msg = \"We ran into an error trying to fetch your TD.\";\n              console.error(msg, ex);\n              linkedTd[href] = currentLinkedTd;\n            }\n          }\n          else {\n            linkedTd[href] = currentLinkedTd;\n          }\n          if (rel !== \"\") {\n            link.rel = rel.trim();\n          }\n          if (type !== \"\") {\n            link.type = type.trim();\n          }\n\n          if (href === \"\") {\n            showHrefErrorMessage(\"The href field is mandatory ...\");\n          }\n          else if (checkIfLinkExists(link)) {\n            showHrefErrorMessage(\"A Link with the target Thing Description already exists ...\");\n          }\n          else {\n            addLinksToTd(link);\n            context.addLinkedTd(linkedTd);\n            setCurrentLinkedTd({});\n            close();\n          }\n        }}\n\n        submitText={\"Add\"}\n        children={children}\n        title={`Add Link `}\n        description={`Tell us how this ${tdJSON.title} can interact with other ressources`}\n      />,\n      document.getElementById(\"modal-root\"));\n  }\n\n  return null;\n});\n\nconst showHrefErrorMessage = (msg) => {\n  document.getElementById(\"link-href-info\").textContent = msg;\n  document.getElementById(\"link-href\").classList.remove(\"border-gray-600\");\n  document.getElementById(\"link-href\").classList.add(\"border-red-400\");\n}\n\nconst clearHrefErrorMessage = () => {\n  document.getElementById(\"link-href\").classList.add(\"border-gray-600\");\n  document.getElementById(\"link-href\").classList.remove(\"border-red-400\");\n}\n\n","/********************************************************************************\n * Copyright (c) 2018 - 2021 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React from 'react';\nimport { Info } from 'react-feather';\nimport ReactTooltip from 'react-tooltip';\n\n/**\n * Display an info icon that shows a information text when hovered\n * next to the child.\n *\n * The parameter tooltip a TooltipContent object containing HTML on how\n * the tooltip is rendered and a link that gets called onClick.\n * @param {TooltipContent} tooltip\n * @param {Object} children\n */\nexport const InfoIconWrapper = (props) => {\n    return (\n        <div className=\"flex flex-row items-center\">\n            <div className=\"pr-0.5\">\n                {props.children}\n            </div>\n            <button onClick={() => window.open(props.tooltip.href, \"_blank\")}>\n                <InfoIcon html={props.tooltip.html} />\n            </button>\n            <div className=\"p-1\"></div>\n        </div >\n    );\n}\n\n/**\n * Display an info icon that shows a information text when hovered.\n * \n * The parameter html is a String containing HTML for the tooltips layout.\n * @param {String} html\n */\nexport const InfoIcon = (props) => {\n    return (\n        <>\n            <Info color=\"grey\"\n                size=\"16\"\n                data-html={true}\n                data-type=\"info\"\n                data-tip={props.html}\n                data-background-color=\"#2c2c2e\"\n            />\n            <ReactTooltip html={true} type=\"info\" />\n        </ >\n    );\n}","/********************************************************************************\n * Copyright (c) 2018 - 2021 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\n\nclass TooltipContent {\n    constructor(html, href) {\n        this.html = html;\n        this.href = href;\n    }\n}\n\nexport const getPropertiesTooltipContent = () => {\n    const html = `<h2 class='text-lg'>Web of Things Properties</h2>\n                    <p>A Property is a simple attribute of a device. The value of a Property can be readable.</p>\n                    <p>writable or observable. E.g. a Property for a lamp could indicate if it is on or off.</p>\n                    <br />\n                    <p>Click to get more information about Properties.</p> \n                `\n    const href = \"https://www.w3.org/TR/wot-thing-description/#propertyaffordance\";\n    return new TooltipContent(html, href);\n}\n\nexport const getActionsTooltipContent = () => {\n    const html = `<h2 class='text-lg'>Web of Things Actions</h2>\n                    <p>An Action is some kind of procedure that can be triggered on a device. An Action can</p>\n                    <p>be started or cancelled. E.g. an Action for a lamp could be turning it on or off.</p>\n                    <br />\n                    <p>Click to get more information about Actions.</p>\n                `\n    const href = \"https://www.w3.org/TR/wot-thing-description/#actionaffordance\";\n    return new TooltipContent(html, href);\n}\n\nexport const getEventsTooltipContent = () => {\n    const html = `<h2 class='text-lg'>Web of Things Events</h2>\n                <p>An Event is an asynchronously happening information flow. An Event is observable.</p>\n                <p>E.g. an Event for a lamp could fire if it gets turned on or off.</p>\n                <br />\n                <p>Click to get more information about Events.</p>\n            `\n\n    const href = \"https://www.w3.org/TR/wot-thing-description/#eventaffordance\";\n    return new TooltipContent(html, href);\n}\n\nexport const getFormsTooltipContent = () => {\n    const html = `<h2 class='text-lg'>Web of Things Forms</h2>\n                    <p>A Form contains all information needed to make a request to a device.</p>\n                    <p>It can accompany a Property, Action, Event or a Thing itself.</p>\n                    <br />\n                    <p>Click to get more information about Forms.</p>\n                `\n    const href = \"https://www.w3.org/TR/wot-thing-description/#form\";\n\n    return new TooltipContent(html, href);\n}\n\nexport const getLinksTooltipContent = () => {\n    const html = `<h2 class='text-lg'>Web of Things Link</h2>\n                    <p>A link can be viewed as a statement of the form link context has a relation type resource at link target</p>\n                    <p>Used to link Thing Description with other ressources.</p>\n                    <br />\n                    <p>Click to get more information about Links.</p>\n                `\n    const href = \"https://www.w3.org/TR/wot-thing-description/#link\";\n\n    return new TooltipContent(html, href);\n}\n\nexport const tooltipMapper = {\n    \"properties\": getPropertiesTooltipContent(),\n    \"actions\": getActionsTooltipContent(),\n    \"events\": getEventsTooltipContent(),\n    \"forms\": getFormsTooltipContent(),\n    \"links\": getLinksTooltipContent(),\n};","/********************************************************************************\n * Copyright (c) 2018 - 2021 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React, { useContext } from \"react\";\nimport \"../../assets/main.css\"\nimport ediTDorContext from \"../../context/ediTDorContext\";\nimport { Trash2 } from \"react-feather\";\n\nexport default function Form(props) {\n\n    const formChooser = {\n        \"observeproperty\": <ObserveForm type=\"properties\" form={props.form} propName={props.propName} />,\n        \"unobserveproperty\": <UnobserveForm type=\"properties\" form={props.form} propName={props.propName} />,\n        \"observeallproperties\": <ObserveAllForm type=\"forms\" form={props.form} propName={props.propName} />,\n        \"unobserveallproperties\": <UnobserveAllForm type=\"forms\" form={props.form} propName={props.propName} />,\n        \"readproperty\": <ReadForm type=\"properties\" form={props.form} propName={props.propName} />,\n        \"readmultipleproperties\": <ReadMultipleForm type=\"forms\" form={props.form} formIndex={props.propName} />,\n        \"readallproperties\": <ReadAllForm type=\"forms\" form={props.form} formIndex={props.propName} />,\n        \"writeproperty\": <WriteForm type=\"properties\" form={props.form} propName={props.propName} />,\n        \"writemultipleproperties\": <WriteMultipleForm type=\"forms\" form={props.form} formIndex={props.propName} />,\n        \"writeallproperties\": <WriteAllForm type=\"forms\" form={props.form} formIndex={props.propName} />,\n        \"invokeaction\": <InvokeForm type=\"actions\" form={props.form} propName={props.propName} />,\n        \"unsubscribeevent\": <UnobserveForm type=\"events\" form={props.form} propName={props.propName} />,\n    }\n\n    if (formChooser[props.form.op]) {\n        return formChooser[props.form.op];\n    }\n\n    if (props.interactionType === \"action\") {\n        return <InvokeForm type=\"actions\" form={props.form} propName={props.propName} />\n    } else if (props.interactionType === \"event\") {\n        return <ObserveForm type=\"events\" form={props.form} propName={props.propName} />\n    }\n\n    return <UndefinedForm form={props.form} propName={props.propName} />\n}\n\nexport function ObserveForm(props) {\n    const context = useContext(ediTDorContext)\n    const deleteForm = (e) => {\n        context.removeForm(e)\n    }\n    return (\n        <div className=\"flex flex-row items-center justify-start h-10 w-full bg-formOrange rounded-md px-4 mt-2 bg-opacity-75 border-2 border-formOrange\">\n            <div className=\"flex h-6 w-16 bg-white rounded-md place-self-center justify-center\">\n                <div className=\"text-formOrange place-self-center text-center text-xs px-4\">Observe</div>\n            </div>\n            <div className=\"place-self-center pl-3 text-base text-white overflow-hidden flex-grow\">{props.form.href}</div>\n            <button className=\"text-base w-6 h-6 p-1 m-1 shadow-md rounded-full bg-formOrange\" onClick={() => deleteForm(props)}>\n                <Trash2 size={16} color=\"black\" />\n            </button>\n        </div>\n    );\n}\n\nexport function UnobserveForm(props) {\n    const context = useContext(ediTDorContext)\n    const deleteForm = (e) => {\n        context.removeForm(e)\n    }\n    return (\n        <div className=\"flex flex-row items-center justify-start h-10 w-full bg-formRed rounded-md px-4 mt-2 bg-opacity-75 border-2 border-formRed\">\n            <div className=\"flex h-6 w-16 bg-white rounded-md place-self-center justify-center\">\n                <div className=\"text-formRed place-self-center text-center text-xs px-4\">Unobserve</div>\n            </div>\n            <div className=\" place-self-center pl-3 text-base text-white overflow-hidden flex-grow\">{props.form.href}</div>\n            <button className=\"text-base w-6 h-6 p-1 m-1 shadow-md rounded-full bg-formRed\" onClick={() => deleteForm(props)}>\n                <Trash2 size={16} color=\"black\" />\n            </button>\n        </div>\n    );\n}\n\nexport function ObserveAllForm(props) {\n    const context = useContext(ediTDorContext)\n    const deleteForm = (e) => {\n        context.removeForm(e)\n    }\n    return (\n        <div className=\"flex flex-row items-center justify-start h-10 w-full bg-formOrange rounded-md px-4 mt-2 bg-opacity-75 border-2 border-formOrange\">\n            <div className=\"flex h-6 w-18 bg-white rounded-md place-self-center justify-center\">\n                <div className=\"text-formOrange place-self-center text-center text-xs px-4\">ObserveAll</div>\n            </div>\n            <div className=\"place-self-center pl-3 text-base text-white overflow-hidden flex-grow\">{props.form.href}</div>\n            <button className=\"text-base w-6 h-6 p-1 m-1 shadow-md rounded-full bg-formOrange\" onClick={() => deleteForm(props)}>\n                <Trash2 size={16} color=\"black\" />\n            </button>\n        </div>\n    );\n}\n\nexport function UnobserveAllForm(props) {\n    const context = useContext(ediTDorContext)\n    const deleteForm = (e) => {\n        context.removeForm(e)\n    }\n    return (\n        <div className=\"flex flex-row items-center justify-start h-10 w-full bg-formRed rounded-md px-4 mt-2 bg-opacity-75 border-2 border-formRed\">\n            <div className=\"flex h-6 w-18 bg-white rounded-md place-self-center justify-center\">\n                <div className=\"text-formRed place-self-center text-center text-xs px-4\">UnobserveAll</div>\n            </div>\n            <div className=\" place-self-center pl-3 text-base text-white overflow-hidden flex-grow\">{props.form.href}</div>\n            <button className=\"text-base w-6 h-6 p-1 m-1 shadow-md rounded-full bg-formRed\" onClick={() => deleteForm(props)}>\n                <Trash2 size={16} color=\"black\" />\n            </button>\n        </div>\n    );\n}\n\nexport function ReadForm(props) {\n    const context = useContext(ediTDorContext)\n    const deleteForm = (e) => {\n        context.removeForm(e)\n    }\n    return (\n        <div className=\"flex flex-row items-center justify-start h-10 w-full bg-formGreen rounded-md px-4 mt-2 bg-opacity-75 border-2 border-formGreen\">\n            <div className=\"flex h-6 w-16 bg-white rounded-md place-self-center justify-center\">\n                <div className=\"text-formGreen place-self-center text-center text-xs px-4\">Read</div>\n            </div>\n            <div className=\" place-self-center pl-3 text-base text-white overflow-hidden flex-grow\">{props.form.href}</div>\n            <button className=\"text-base w-6 h-6 p-1 m-1 shadow-md rounded-full bg-formGreen\" onClick={() => deleteForm(props)}>\n                <Trash2 size={16} color=\"black\" />\n            </button>\n        </div>\n    );\n}\n\nexport function ReadMultipleForm(props) {\n    const context = useContext(ediTDorContext)\n    const deleteForm = (e) => {\n        context.removeForm(e)\n    }\n    return (\n        <div className=\"flex flex-row items-center justify-start h-10 w-full bg-formGreen rounded-md px-4 mt-2 bg-opacity-75 border-2 border-formGreen\">\n            <div className=\"flex h-6 w-18 bg-white rounded-md place-self-center justify-center\">\n                <div className=\"text-formGreen place-self-center text-center text-xs px-4\">ReadMultiple</div>\n            </div>\n            <div className=\" place-self-center pl-3 text-base text-white overflow-hidden flex-grow\">{props.form.href}</div>\n            <button className=\"text-base w-6 h-6 p-1 m-1 shadow-md rounded-full bg-formGreen\" onClick={() => deleteForm(props)}>\n                <Trash2 size={16} color=\"black\" />\n            </button>\n        </div>\n    );\n}\n\nexport function ReadAllForm(props) {\n    const context = useContext(ediTDorContext)\n    const deleteForm = (e) => {\n        context.removeForm(e)\n    }\n    return (\n        <div className=\"flex flex-row items-center justify-start h-10 w-full bg-formGreen rounded-md px-4 mt-2 bg-opacity-75 border-2 border-formGreen\">\n            <div className=\"flex h-6 w-18 bg-white rounded-md place-self-center justify-center\">\n                <div className=\"text-formGreen place-self-center text-center text-xs px-4\">ReadAll</div>\n            </div>\n            <div className=\" place-self-center pl-3 text-base text-white overflow-hidden flex-grow\">{props.form.href}</div>\n            <button className=\"text-base w-6 h-6 p-1 m-1 shadow-md rounded-full bg-formGreen\" onClick={() => deleteForm(props)}>\n                <Trash2 size={16} color=\"black\" />\n            </button>\n        </div>\n    );\n}\n\nexport function WriteForm(props) {\n    const context = useContext(ediTDorContext)\n    const deleteForm = (e) => {\n        context.removeForm(e)\n    }\n    return (\n        <div className=\"flex flex-row items-center justify-start h-10 w-full bg-formBlue rounded-md px-4 mt-2 bg-opacity-75 border-2 border-formBlue\">\n            <div className=\"flex h-6 w-16 bg-white rounded-md place-self-center justify-center\">\n                <div className=\"text-formBlue place-self-center text-center text-xs px-4\">Write</div>\n            </div>\n            <div className=\" place-self-center pl-3 text-base text-white overflow-hidden flex-grow\">{props.form.href}</div>\n            <button className=\"text-base w-6 h-6 p-1 m-1 shadow-md rounded-full bg-formBlue\" onClick={() => deleteForm(props)}>\n                <Trash2 size={16} color=\"black\" />\n            </button>\n        </div>\n    );\n}\n\nexport function WriteMultipleForm(props) {\n    const context = useContext(ediTDorContext)\n    const deleteForm = (e) => {\n        context.removeForm(e)\n    }\n    return (\n        <div className=\"flex flex-row items-center justify-start h-10 w-full bg-formBlue rounded-md px-4 mt-2 bg-opacity-75 border-2 border-formBlue\">\n            <div className=\"flex h-6 w-18 bg-white rounded-md place-self-center justify-center\">\n                <div className=\"text-formBlue place-self-center text-center text-xs px-4\">WriteMultiple</div>\n            </div>\n            <div className=\" place-self-center pl-3 text-base text-white overflow-hidden flex-grow\">{props.form.href}</div>\n            <button className=\"text-base w-6 h-6 p-1 m-1 shadow-md rounded-full bg-formBlue\" onClick={() => deleteForm(props)}>\n                <Trash2 size={16} color=\"black\" />\n            </button>\n        </div>\n    );\n}\n\nexport function WriteAllForm(props) {\n    const context = useContext(ediTDorContext)\n    const deleteForm = (e) => {\n        context.removeForm(e)\n    }\n    return (\n        <div className=\"flex flex-row items-center justify-start h-10 w-full bg-formBlue rounded-md px-4 mt-2 bg-opacity-75 border-2 border-formBlue\">\n            <div className=\"flex h-6 w-18 bg-white rounded-md place-self-center justify-center\">\n                <div className=\"text-formBlue place-self-center text-center text-xs px-4\">WriteAll</div>\n            </div>\n            <div className=\" place-self-center pl-3 text-base text-white overflow-hidden flex-grow\">{props.form.href}</div>\n            <button className=\"text-base w-6 h-6 p-1 m-1 shadow-md rounded-full bg-formBlue\" onClick={() => deleteForm(props)}>\n                <Trash2 size={16} color=\"black\" />\n            </button>\n        </div>\n    );\n}\n\n\nexport function InvokeForm(props) {\n    const context = useContext(ediTDorContext)\n    const deleteForm = (e) => {\n        context.removeForm(e)\n    }\n    return (\n        <div className=\"flex flex-row items-center justify-start h-10 w-full bg-formRed rounded-md px-4 mt-2 bg-opacity-75 border-2 border-formRed\">\n            <div className=\"flex h-6 w-16 bg-white rounded-md place-self-center justify-center\">\n                <div className=\"text-formRed place-self-center text-center text-xs px-4\">Invoke</div>\n            </div>\n            <div className=\" place-self-center pl-3 text-base text-white overflow-hidden flex-grow\">{props.form.href}</div>\n            <button className=\"text-base w-6 h-6 p-1 m-1 shadow-md rounded-full bg-formRed\" onClick={() => deleteForm(props)}>\n                <Trash2 size={16} color=\"black\" />\n            </button>\n        </div>\n    );\n}\n\nexport function UndefinedForm(props) {\n    const context = useContext(ediTDorContext)\n    const deleteForm = (e) => {\n        context.removeForm(e)\n    }\n    return (\n        <div className=\"flex flex-row items-center justify-start h-10 w-full bg-gray-300 rounded-md px-4 mt-2 bg-opacity-75 border-2 border-gray-300\">\n            <div className=\"flex h-6 w-16 bg-white rounded-md place-self-center justify-center\">\n                <div className=\"place-self-center text-center text-xs px-4\">Undefined</div>\n            </div>\n            <div className=\" place-self-center pl-3 text-base overflow-hidden flex-grow\">{props.form.href}</div>\n            <button className=\"text-base w-6 h-6 p-1 m-1 shadow-md rounded-full bg-white\" onClick={() => deleteForm(props)}>\n                <Trash2 size={16} color=\"black\" />\n            </button>\n        </div>\n    );\n}","/********************************************************************************\n * Copyright (c) 2018 - 2021 Contributors to the Eclipse Foundation\n *\n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n *\n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React, { useContext } from \"react\";\nimport \"../../assets/main.css\"\nimport ediTDorContext from \"../../context/ediTDorContext\";\nimport { Trash2, Info } from \"react-feather\";\nimport { changeBetweenTd } from '../../util';\n\nexport default function Link(props) {\n\n  const context = useContext(ediTDorContext)\n  const deleteLink = (e) => {\n    let currentLinkedTd = context.linkedTd;\n    //update the linkedTd after removing the current linked Td\n    if (currentLinkedTd[e.link.href]) {\n      delete currentLinkedTd[e.link.href];\n      context.updateLinkedTd(currentLinkedTd);\n    }\n    context.removeLink(e.propName);\n    context.updateIsModified(true);\n\n  }\n  const infoLink = async (e) => {\n    let href = e.link.href;\n    changeBetweenTd(context, href);\n  }\n  return (\n    <div className=\"flex flex-row items-center justify-start h-10 w-full bg-formBlue rounded-md px-4 mt-2 bg-opacity-75 border-2 border-formBlue\">\n      <div className=\"flex h-6 w-18 bg-white rounded-md place-self-center justify-center\">\n        {props.link.rel && <div className=\"text-formBlue place-self-center text-center text-xs px-4\">{props.link.rel}</div>}\n      </div>\n      <div className=\" place-self-center pl-3 text-base text-white overflow-hidden flex-grow\">{props.link.href}</div>\n      <button className=\"text-base w-6 h-6 p-1 m-1 shadow-md rounded-full bg-formBlue\" onClick={() => deleteLink(props)}>\n        <Trash2 size={16} color=\"black\" />\n      </button>\n      {context.linkedTd && context.linkedTd[props.link.href] && ((Object.keys(context.linkedTd[props.link.href]).length) || context.linkedTd[props.link.href][\"kind\"] === \"file\") &&\n        <button className=\"text-base w-6 h-6 p-1 m-1 shadow-md rounded-full bg-formBlue\" onClick={() => infoLink(props)}>\n          <Info size={16} color=\"black\" />\n        </button>}\n    </div>\n  );\n}\n","/********************************************************************************\n * Copyright (c) 2018 - 2021 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React from 'react';\nimport { ChevronDown } from 'react-feather';\n\nexport const DialogTextField = (props) => {\n    return <div key={props.id} className=\"py-1\">\n        <label htmlFor={props.id} className=\"text-sm text-gray-400 font-medium pl-2\">{props.label}:</label>\n        <input\n            name={props.id}\n            id={props.id}\n            className=\"border-gray-600 bg-gray-600 w-full p-2 sm:text-sm border-2 text-white rounded-md focus:outline-none focus:border-blue-500\"\n            placeholder={props.placeholder}\n            type={props.type ?? \"text\"}\n            autoFocus={props.autoFocus ?? false}\n            onChange={props.onChange ? () => props.onChange() : null}\n        />\n        <span id={`${props.id}-helper-text`} className=\"text-xs text-red-400 pl-2\"></span>\n    </div>;\n}\n\nexport const DialogTextArea = (props) => {\n    return <>\n        <label htmlFor={props.id} className=\"text-sm text-gray-400 font-medium pl-2\">{props.label}:</label>\n        <textarea\n            id={props.id}\n            rows=\"5\"\n            className=\"bg-gray-600\n                sm:text-sm\n                appearance-none \n                border-2 border-gray-600 rounded w-full \n                p-2\n                text-white \n                leading-tight \n                focus:outline-none \n                focus:border-blue-500\"\n            placeholder={props.placeholder}\n        />\n    </>;\n}\n\nexport const DialogDropdown = (props) => {\n    return <>\n        <label htmlFor={props.id} className=\"text-sm text-gray-400 font-medium pl-2\">{props.label}:</label>\n        <div className=\"relative\">\n            <select className=\"block appearance-none w-full bg-gray-600 border-2 border-gray-600 text-white py-3 px-4 pr-8 rounded leading-tight focus:border-blue-500 focus:outline-none\" id={props.id}>\n                {props.options.map((e) => { return <option key={e}>{e}</option> })}\n            </select>\n            <div className=\"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700\">\n                <ChevronDown color=\"#cacaca\"></ChevronDown>\n            </div>\n        </div>\n    </>;\n\n}\n\nexport const DialogCheckbox = (props) => {\n    return <div key={props.id} className=\"form-checkbox pl-2\">\n        {\n            props.readOnly ?? true ?\n                <input id={props.id}\n                    className=\"form-checkbox-input\"\n                    type=\"checkbox\"\n                    value={props.label}\n                /> :\n                <input id={props.id}\n                    className=\"form-checkbox-input\"\n                    type=\"checkbox\"\n                    value={props.label}\n                    readOnly={props.readOnly}\n                    checked={true}\n                />\n        }\n        <label className=\"form-checkbox-label pl-2\" htmlFor={props.id}>{props.label}</label>\n    </div>;\n}\n","/********************************************************************************\n * Copyright (c) 2018 - 2021 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React, { forwardRef, useContext, useEffect, useImperativeHandle } from 'react';\nimport ReactDOM from \"react-dom\";\nimport ediTDorContext from \"../../context/ediTDorContext\";\nimport { DialogTextArea, DialogTextField } from './DialogComponents';\nimport { DialogTemplate } from \"./DialogTemplate\";\n\nexport const AddActionDialog = forwardRef((_, ref) => {\n    const context = useContext(ediTDorContext);\n    const [display, setDisplay] = React.useState(() => { return false });\n\n    const type = \"action\";\n    const key = \"actions\";\n    const name = type && type[0].toUpperCase() + type.slice(1);\n\n    useEffect(() => {\n    }, [display, context]);\n\n    useImperativeHandle(ref, () => {\n        return {\n            openModal: () => open(),\n            close: () => close()\n        }\n    });\n\n    const open = () => {\n        setDisplay(true)\n    };\n\n    const close = () => {\n        setDisplay(false);\n    };\n\n    const children = <>\n        <DialogTextField\n            id={`${type}-title`}\n            label=\"Title\"\n            placeholder={`${name} Title`}\n            autoFocus={true}\n            onChange={() => clearErrorMessage()}\n        />\n        <DialogTextArea\n            id={`${type}-description`}\n            label=\"Description\"\n            placeholder={`A short description about the new ${name}...`}\n        />\n    </>;\n\n    const onAddAction = () => {\n        let action = {};\n        action.title = document.getElementById(`${type}-title`).value;\n\n        const description = document.getElementById(`${type}-description`).value;\n        if (description !== \"\") {\n            action.description = description;\n        }\n        action.forms = [];\n\n        let td = JSON.parse(context.offlineTD);\n        if (td[key] && td[key][action.title]) {\n            showErrorMessage(`An ${name} with this title already exists...`);\n        } else {\n            addActionToTd(action);\n            close();\n        }\n    }\n\n    const addActionToTd = (action) => {\n        let td = JSON.parse(context.offlineTD);\n\n        if (!td[key]) {\n            td[key] = {};\n        }\n\n        td[key][action.title] = action;\n        context.updateOfflineTD(JSON.stringify(td, null, 2))\n        return;\n    }\n\n    const showErrorMessage = (msg) => {\n        document.getElementById(`${type}-title-helper-text`).textContent = msg;\n        document.getElementById(`${type}-title`).classList.remove(\"border-gray-600\");\n        document.getElementById(`${type}-title`).classList.add(\"border-red-400\");\n    }\n\n    const clearErrorMessage = () => {\n        document.getElementById(`${type}-title-helper-text`).textContent = \"\";\n        document.getElementById(`${type}-title`).classList.add(\"border-gray-600\");\n        document.getElementById(`${type}-title`).classList.remove(\"border-red-400\");\n    }\n\n    if (display) {\n        return ReactDOM.createPortal(\n            <DialogTemplate\n                onCancel={close}\n                onSubmit={() => {\n                    onAddAction();\n                }}\n                submitText={`Add ${name}`}\n                children={children}\n                title={`Add New ${name}`}\n                description={`Tell us a little something about the ${name} you want to add.`}\n            />,\n            document.getElementById(\"modal-root\"));\n    }\n\n    return null;\n});\n\n","/********************************************************************************\n * Copyright (c) 2018 - 2021 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React, { forwardRef, useContext, useEffect, useImperativeHandle } from 'react';\nimport ReactDOM from \"react-dom\";\nimport ediTDorContext from \"../../context/ediTDorContext\";\nimport { DialogTextArea, DialogTextField } from './DialogComponents';\nimport { DialogTemplate } from \"./DialogTemplate\";\n\nexport const AddEventDialog = forwardRef((_, ref) => {\n    const context = useContext(ediTDorContext);\n    const [display, setDisplay] = React.useState(() => { return false });\n\n    const type = \"event\";\n    const key = \"events\";\n    const name = type && type[0].toUpperCase() + type.slice(1);\n\n    useEffect(() => {\n    }, [display, context]);\n\n    useImperativeHandle(ref, () => {\n        return {\n            openModal: () => open(),\n            close: () => close()\n        }\n    });\n\n    const open = () => {\n        setDisplay(true)\n    };\n\n    const close = () => {\n        setDisplay(false);\n    };\n\n    const children = <>\n        <DialogTextField\n            id={`${type}-title`}\n            label=\"Title\"\n            placeholder={`${name} Title`}\n            autoFocus={true}\n            onChange={() => clearErrorMessage()}\n        />\n        <DialogTextArea\n            id={`${type}-description`}\n            label=\"Description\"\n            placeholder={`A short description about the new ${name}...`}\n        />\n    </>;\n\n    const onAddEvent = () => {\n        let event = {};\n        event.title = document.getElementById(`${type}-title`).value;\n\n        const description = document.getElementById(`${type}-description`).value;\n        if (description !== \"\") {\n            event.description = description;\n        }\n        event.forms = [];\n\n        let td = JSON.parse(context.offlineTD);\n        if (td[key] && td[key][event.title]) {\n            showErrorMessage(`An ${name} with this title already exists...`);\n        } else {\n            addEventToTd(event);\n            close();\n        }\n    }\n\n    const addEventToTd = (event) => {\n        let td = JSON.parse(context.offlineTD);\n\n        if (!td[key]) {\n            td[key] = {};\n        }\n\n        td[key][event.title] = event;\n        context.updateOfflineTD(JSON.stringify(td, null, 2))\n        return;\n    }\n\n    const showErrorMessage = (msg) => {\n        document.getElementById(`${type}-title-helper-text`).textContent = msg;\n        document.getElementById(`${type}-title`).classList.remove(\"border-gray-600\");\n        document.getElementById(`${type}-title`).classList.add(\"border-red-400\");\n    }\n\n    const clearErrorMessage = () => {\n        document.getElementById(`${type}-title-helper-text`).textContent = \"\";\n        document.getElementById(`${type}-title`).classList.add(\"border-gray-600\");\n        document.getElementById(`${type}-title`).classList.remove(\"border-red-400\");\n    }\n\n\n    if (display) {\n        return ReactDOM.createPortal(\n            <DialogTemplate\n                onCancel={close}\n                onSubmit={() => {\n                    onAddEvent();\n                }}\n                submitText={`Add ${name}`}\n                children={children}\n                title={`Add New ${name}`}\n                description={`Tell us a little something about the ${name} you want to add.`}\n            />,\n            document.getElementById(\"modal-root\"));\n    }\n\n    return null;\n});\n\n","/********************************************************************************\n * Copyright (c) 2018 - 2021 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React, { forwardRef, useContext, useEffect, useImperativeHandle } from 'react';\nimport ReactDOM from \"react-dom\";\nimport ediTDorContext from \"../../context/ediTDorContext\";\nimport { DialogCheckbox, DialogDropdown, DialogTextArea, DialogTextField } from './DialogComponents';\nimport { DialogTemplate } from \"./DialogTemplate\";\n\nconst NO_TYPE = \"undefined\";\n\nexport const AddPropertyDialog = forwardRef((_, ref) => {\n    const context = useContext(ediTDorContext);\n    const [display, setDisplay] = React.useState(() => { return false });\n\n    const type = \"property\";\n    const key = \"properties\";\n    const name = type && type[0].toUpperCase() + type.slice(1);\n\n    useEffect(() => {\n    }, [display, context]);\n\n    useImperativeHandle(ref, () => {\n        return {\n            openModal: () => open(),\n            close: () => close()\n        }\n    });\n\n    const open = () => {\n        setDisplay(true)\n    };\n\n    const close = () => {\n        setDisplay(false);\n    };\n\n    const children = <>\n        <DialogTextField\n            id={`${type}-title`}\n            label=\"Title\"\n            placeholder={`${name} Title`}\n            autoFocus={true}\n            onChange={() => clearErrorMessage()}\n        />\n        <DialogTextArea\n            id={`${type}-description`}\n            label=\"Description\"\n            placeholder={`A short description about the new ${name}...`}\n        />\n        <DialogDropdown\n            id={`${type}-type`}\n            label=\"Type\"\n            options={[NO_TYPE, \"number\", \"integer\", \"boolean\", \"string\", \"object\", \"array\",]}\n        />\n        <div className=\"h-2\"></div>\n        <label className=\"text-sm text-gray-400 font-medium pl-3\">Additional:</label>\n        <div id=\"additional\" className=\"bg-gray-600 p-1 rounded-md\">\n            <DialogCheckbox\n                id={`${type}-readOnly`}\n                label=\"Read Only\"\n            />\n            <DialogCheckbox\n                id={`${type}-observable`}\n                label=\"Observable\"\n            />\n        </div>\n    </>;\n\n    const onAddProperty = () => {\n        let property = {};\n        property.title = document.getElementById(`${type}-title`).value;\n        property.observable = document.getElementById(`${type}-observable`).checked;\n        property.readOnly = document.getElementById(`${type}-readOnly`).checked;\n\n        const description = document.getElementById(`${type}-description`).value;\n        if (description !== \"\") {\n            property.description = description;\n        }\n\n        const dataType = document.getElementById(`${type}-type`).value;\n        if (dataType !== NO_TYPE) {\n            property.type = dataType;\n        }\n        if (dataType === \"array\") {\n            property.items = {};\n        }\n        else if (dataType === \"object\") {\n            property.properties = {};\n        }\n\n        property.forms = [];\n\n        let td = JSON.parse(context.offlineTD);\n        if (td[key] && td[key][property.title]) {\n            showErrorMessage(`A ${name} with this title already exists...`);\n        } else {\n            addPropertyToTd(property);\n            close();\n        }\n    }\n\n    const addPropertyToTd = (property) => {\n        let td = JSON.parse(context.offlineTD);\n\n        if (!td[key]) {\n            td[key] = {};\n        }\n\n        td[key][property.title] = property;\n        context.updateOfflineTD(JSON.stringify(td, null, 2))\n        return;\n    }\n\n    const showErrorMessage = (msg) => {\n        document.getElementById(`${type}-title-helper-text`).textContent = msg;\n        document.getElementById(`${type}-title`).classList.remove(\"border-gray-600\");\n        document.getElementById(`${type}-title`).classList.add(\"border-red-400\");\n    }\n\n    const clearErrorMessage = () => {\n        document.getElementById(`${type}-title-helper-text`).textContent = \"\";\n        document.getElementById(`${type}-title`).classList.add(\"border-gray-600\");\n        document.getElementById(`${type}-title`).classList.remove(\"border-red-400\");\n    }\n\n    if (display) {\n        return ReactDOM.createPortal(\n            <DialogTemplate\n                onCancel={close}\n                onSubmit={() => {\n                    onAddProperty();\n                }}\n                submitText={`Add ${name}`}\n                children={children}\n                title={`Add New ${name}`}\n                description={`Tell us a little something about the ${name} you want to add.`}\n            />,\n            document.getElementById(\"modal-root\"));\n    }\n\n    return null;\n});\n\n","/********************************************************************************\n * Copyright (c) 2018 - 2021 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React, { useContext } from \"react\";\nimport { PlusCircle, Trash2 } from \"react-feather\";\nimport \"../../assets/main.css\";\nimport ediTDorContext from \"../../context/ediTDorContext\";\nimport { buildAttributeListObject, separateForms } from \"../../util.js\";\nimport { AddFormDialog } from \"../Dialogs/AddFormDialog\";\nimport { InfoIconWrapper } from \"../InfoIcon/InfoIcon\";\nimport { getFormsTooltipContent } from \"../InfoIcon/InfoTooltips\";\nimport Form from \"./Form\";\n\nconst alreadyRenderedKeys = [\"title\", \"forms\", \"description\"];\n\nexport default function Action(props) {\n    const context = useContext(ediTDorContext);\n\n    const addFormDialog = React.useRef();\n    const openAddFormDialog = () => { addFormDialog.current.openModal() }\n\n    if ((Object.keys(props.action).length === 0 && props.action.constructor !== Object)) {\n        return <div className=\"text-3xl text-white\">Action could not be rendered because mandatory fields are missing.</div>\n    }\n\n    const action = props.action;\n    const forms = separateForms(props.action.forms);\n    const attributeListObject = buildAttributeListObject({ name: props.actionName }, props.action, alreadyRenderedKeys);\n    const attributes = Object.keys(attributeListObject).map(x => {\n        return <li key={x}>{x} : {JSON.stringify(attributeListObject[x])}</li>\n    });\n\n    const onDeleteActionClicked = () => {\n        context.removeOneOfAKindReducer('actions', props.actionName)\n    }\n\n    return (\n        <details>\n            <summary className=\"text-xl text-gray-400 flex flex-row justify-start items-center cursor-pointer p-0.5\">\n                <div className=\"flex-grow\">{action.title ?? props.actionName}</div>\n                <button className=\"text-base w-6 h-6 p-1 m-1 rounded-full bg-gray-400\" onClick={onDeleteActionClicked}>\n                    <Trash2 size={16} color=\"black\" />\n                </button>\n            </summary>\n            <div className=\"mb-4\">\n                <div className=\"text-lg text-gray-400 pb-2\">{action.description}</div>\n                <ul className=\"text-base text-gray-300 list-disc pl-8\">{attributes}</ul>\n                <div className=\"flex flex-row items-center \">\n                    <div className=\"flex flex-grow\">\n                        <InfoIconWrapper className=\" flex-grow\" tooltip={getFormsTooltipContent()}>\n                            <h4 className=\"text-lg text-gray-400 pr-1 text-bold\">Forms</h4>\n                        </InfoIconWrapper>\n                    </div>\n                    <button onClick={openAddFormDialog}>\n                        <PlusCircle color=\"#cacaca\" size=\"18\" />\n                    </button>\n                    <AddFormDialog type=\"action\"\n                        interaction={action}\n                        interactionName={props.actionName}\n                        ref={addFormDialog}\n                    />\n                </div>\n                {forms.map((form, i) => (\n                    <Form key={i} form={form} propName={props.actionName} interactionType={\"action\"}></Form>\n                ))}\n            </div>\n        </details>\n    )\n}","/********************************************************************************\n * Copyright (c) 2018 - 2021 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React, { useContext } from \"react\";\nimport { PlusCircle, Trash2 } from \"react-feather\";\nimport \"../../assets/main.css\";\nimport ediTDorContext from \"../../context/ediTDorContext\";\nimport { buildAttributeListObject, separateForms } from \"../../util.js\";\nimport { AddFormDialog } from \"../Dialogs/AddFormDialog\";\nimport { InfoIconWrapper } from \"../InfoIcon/InfoIcon\";\nimport { getFormsTooltipContent } from \"../InfoIcon/InfoTooltips\";\nimport Form from \"./Form\";\n\nconst alreadyRenderedKeys = [\"title\", \"forms\", \"description\"];\n\nexport default function Event(props) {\n    const context = useContext(ediTDorContext);\n\n    const addFormDialog = React.useRef();\n    const openAddFormDialog = () => { addFormDialog.current.openModal() }\n\n    if ((Object.keys(props.event).length === 0 && props.event.constructor !== Object)) {\n        return <div className=\"text-3xl text-white\">Event could not be rendered because mandatory fields are missing.</div>\n    }\n\n    const event = props.event;\n    const forms = separateForms(props.event.forms);\n    const attributeListObject = buildAttributeListObject({ name: props.eventName }, props.event, alreadyRenderedKeys);\n    const attributes = Object.keys(attributeListObject).map(x => {\n        return <li key={x}>{x} : {JSON.stringify(attributeListObject[x])}</li>\n    });\n\n    const onDeleteEventClicked = () => {\n        context.removeOneOfAKindReducer('events', props.eventName)\n    }\n\n    return (\n        <details>\n            <summary className=\"text-xl text-gray-400 flex flex-row justify-start items-center cursor-pointer p-0.5\">\n                <div className=\"flex-grow\">{event.title ?? props.eventName}</div>\n                <button className=\"text-base w-6 h-6 p-1 m-1 rounded-full bg-gray-400\" onClick={onDeleteEventClicked}>\n                    <Trash2 size={16} color=\"black\" />\n                </button>\n            </summary>\n            <div className=\"mb-4\">\n                <div className=\"text-lg text-gray-400 pb-2\">{event.description}</div>\n                <ul className=\"text-base text-gray-300 list-disc pl-8\">{attributes}</ul>\n                <div className=\"flex flex-row items-center \">\n                    <div className=\"flex flex-grow\">\n                        <InfoIconWrapper className=\" flex-grow\" tooltip={getFormsTooltipContent()}>\n                            <h4 className=\"text-lg text-gray-400 pr-1 text-bold\">Forms</h4>\n                        </InfoIconWrapper>\n                    </div>\n                    <button onClick={openAddFormDialog}>\n                        <PlusCircle color=\"#cacaca\" size=\"18\" />\n                    </button>\n                    <AddFormDialog type=\"event\"\n                        interaction={event}\n                        interactionName={props.eventName}\n                        ref={addFormDialog}\n                    />\n                </div>\n                {forms.map((form, i) => (\n                    <Form key={i} form={form} propName={props.eventName} interactionType={\"event\"}></Form>\n                ))}\n            </div>\n        </details>\n    )\n}","/********************************************************************************\n * Copyright (c) 2018 - 2021 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React, { useContext } from \"react\";\nimport { PlusCircle, Trash2 } from \"react-feather\";\nimport \"../../assets/main.css\";\nimport ediTDorContext from \"../../context/ediTDorContext\";\nimport { buildAttributeListObject, separateForms } from \"../../util.js\";\nimport { AddFormDialog } from \"../Dialogs/AddFormDialog\";\nimport { InfoIconWrapper } from \"../InfoIcon/InfoIcon\";\nimport { getFormsTooltipContent } from \"../InfoIcon/InfoTooltips\";\nimport Form from \"./Form\";\n\nconst alreadyRenderedKeys = [\"title\", \"forms\", \"description\"];\n\nexport default function Property(props) {\n    const context = useContext(ediTDorContext);\n\n    const addFormDialog = React.useRef()\n    const openAddFormDialog = () => { addFormDialog.current.openModal() }\n\n    if ((Object.keys(props.prop).length === 0 && props.prop.constructor !== Object)) {\n        return <div className=\"text-3xl text-white\">Property could not be rendered because mandatory fields are missing.</div>\n    }\n\n    const property = props.prop;\n    const forms = separateForms(props.prop.forms);\n\n    const attributeListObject = buildAttributeListObject({ name: props.propName }, props.prop, alreadyRenderedKeys);\n    const attributes = Object.keys(attributeListObject).map(x => {\n        return <li key={x}>{x} : {JSON.stringify(attributeListObject[x])}</li>\n    });\n\n    const onDeletePropertyClicked = () => {\n        context.removeOneOfAKindReducer('properties', props.propName)\n    }\n\n    return (\n        <details>\n            <summary className=\"text-xl text-gray-400 flex flex-row w-full justify-start items-center cursor-pointer p-0.5\">\n                <h3 className=\"flex-grow\">{property.title ?? props.propName}</h3>\n                <button className=\"text-base w-6 h-6 p-1 m-1 rounded-full bg-gray-400\" onClick={onDeletePropertyClicked}>\n                    <Trash2 size={16} color=\"black\" />\n                </button>\n            </summary>\n            <div className=\"mb-4\">\n                <div className=\"text-lg text-gray-400 pb-2\">{property.description}</div>\n                <ul className=\"list-disc text-base text-gray-300 pl-8\">{attributes}</ul>\n                <div className=\"flex justify-start items-center pt-2\">\n                    <div className=\"flex flex-grow\">\n                        <InfoIconWrapper className=\" flex-grow\" tooltip={getFormsTooltipContent()}>\n                            <h4 className=\"text-lg text-gray-400 pr-1 text-bold\">Forms</h4>\n                        </InfoIconWrapper>\n                    </div>\n                    <button onClick={openAddFormDialog}>\n                        <PlusCircle color=\"#cacaca\" size=\"18\" />\n                    </button>\n                    <AddFormDialog type=\"property\"\n                        interaction={property}\n                        interactionName={props.propName}\n                        ref={addFormDialog}\n                    />\n                </div>\n                {forms.map((form, i) => (\n                    <Form key={i} propName={props.propName} form={form} interactionType={\"property\"} className=\"last:pb-4\"></Form>\n                ))}\n            </div>\n        </details >\n    )\n}","/********************************************************************************\n * Copyright (c) 2018 - 2021 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React from \"react\";\nimport { Search } from \"react-feather\";\n\nexport const SearchBar = (props) => {\n    return (\n        <div className=\"relative text-gray-600\">\n            <input type=\"search\"\n                autoComplete=\"on\"\n                className=\"caret-gray bg-gray-600 text-white px-5 pr-10 place-self-center rounded-lg text-sm focus:outline-none h-9\"\n                onKeyUp={props.onKeyUp}\n                placeholder={props.placeholder}\n                aria-label={props.ariaLabel}\n            />\n            <div disabled type=\"submit\" className=\"cursor-default absolute right-0 top-0 mt-1 mr-4\">\n                <Search color=\"#2c2c2e\"></Search>\n            </div>\n        </div>\n    );\n}","import React, { useContext, useState } from 'react';\nimport ediTDorContext from '../../context/ediTDorContext';\nimport { AddActionDialog } from '../Dialogs/AddActionDialog';\nimport { AddEventDialog } from '../Dialogs/AddEventDialog';\nimport { AddPropertyDialog } from '../Dialogs/AddPropertyDialog';\nimport { InfoIconWrapper } from '../InfoIcon/InfoIcon';\nimport { tooltipMapper } from '../InfoIcon/InfoTooltips';\nimport Action from './Action';\nimport Event from './Event';\nimport Property from './Property';\nimport { SearchBar } from './SearchBar';\n\nconst SORT_ASC = \"asc\";\nconst SORT_DESC = \"desc\";\n\nlet td = {};\nlet oldTd = {};\n\n/**\n * Renders a section for an interaction (Property, Action, Event) with a \n * search bar, a sorting icon and a button to add a new interaction.\n * \n * The parameter interaction can be one of \"Properties\", \"Actions\" or \"Events\".\n * @param {String} interaction\n */\nexport const InteractionSection = (props) => {\n    const [filter, setFilter] = useState(\"\");\n    const [sortOrder, setSortOrder] = useState(SORT_ASC);\n\n    const interaction = props.interaction.toLowerCase();\n    const context = useContext(ediTDorContext);\n\n    try {\n        oldTd = td;\n        const parsedTd = JSON.parse(context.offlineTD);\n        td = parsedTd;\n    } catch (e) {\n        td = oldTd;\n    }\n\n    const updateFilter = (event) => setFilter(event.target.value);\n\n    /**\n    * Returns an Object containing all interactions with keys \n    * matching to the filter.\n    */\n    const applyFilter = () => {\n        if (!td[interaction]) {\n            return;\n        }\n\n        const filtered = {};\n        Object.keys(td[interaction]).filter(e => {\n            if (e.toLowerCase().indexOf(filter.toLowerCase()) > -1) {\n                return true;\n            }\n            else {\n                return false;\n            }\n        }).forEach((key) => {\n            filtered[key] = td[interaction][key];\n        });\n\n        return filtered;\n    }\n\n    const sortKeysInObject = (kind) => {\n        if (!td[kind]) {\n            return;\n        }\n\n        const ordered = {};\n        const toSort = Object.keys(td[kind]).map(x => {\n            return { key: x, title: td[kind][x].title }\n        })\n        if (sortOrder === SORT_ASC) {\n            toSort.sort((a, b) => {\n                const nameA = a.title ? a.title : a.key;\n                const nameB = b.title ? b.title : b.key;\n                return nameA.localeCompare(nameB)\n            }).forEach(function (sortedObject) {\n                ordered[sortedObject.key] = td[kind][sortedObject.key];\n            });\n            setSortOrder(SORT_DESC);\n        } else {\n            toSort.sort((a, b) => {\n                const nameA = a.title ? a.title : a.key;\n                const nameB = b.title ? b.title : b.key;\n                return nameA.localeCompare(nameB)\n            }).reverse().forEach(function (sortedObject) {\n                ordered[sortedObject.key] = td[kind][sortedObject.key];\n            });\n            setSortOrder(SORT_ASC);\n        }\n        td[kind] = ordered\n        context.updateOfflineTD(JSON.stringify(td, null, 2))\n    }\n\n    const sortedIcon = () => {\n        if (sortOrder === SORT_ASC) {\n            return <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"#ffffff\" stroke=\"#ffffff\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                <path d=\"M11 5h10M11 9h7M11 13h4M3 17l3 3 3-3M6 18V4\" />\n            </svg>\n        }\n\n        return (<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"#ffffff\" stroke=\"#ffffff\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n            <path d=\"M11 5h4M11 9h7M11 13h10M3 17l3 3 3-3M6 18V4\" />\n        </svg>)\n    }\n\n    const buildChildren = () => {\n        const filteredInteractions = applyFilter();\n\n        if (td.properties && interaction === \"properties\") {\n            return Object.keys(filteredInteractions).map((key, index) => {\n                return (<Property prop={filteredInteractions[key]} propName={key} key={index} />);\n            });\n        }\n        if (td.actions && interaction === \"actions\") {\n            return Object.keys(filteredInteractions).map((key, index) => {\n                return (<Action action={filteredInteractions[key]} actionName={key} key={index} />);\n            });\n        }\n        if (td.events && interaction === \"events\") {\n            return Object.keys(filteredInteractions).map((key, index) => {\n                return (<Event event={filteredInteractions[key]} eventName={key} key={index} />);\n            });\n        }\n    }\n\n    const createPropertyDialog = React.useRef();\n    const openCreatePropertyDialog = () => { createPropertyDialog.current.openModal() }\n\n    let addInteractionDialog;\n    switch (interaction) {\n        case 'properties': addInteractionDialog = <AddPropertyDialog ref={createPropertyDialog} />; break;\n        case 'actions': addInteractionDialog = <AddActionDialog ref={createPropertyDialog} />; break;\n        case 'events': addInteractionDialog = <AddEventDialog ref={createPropertyDialog} />; break;\n        default:\n    }\n\n    return (\n        <>\n            <div className=\"flex justify-start items-end pt-8 pb-4\">\n                <div className=\"flex flex-grow\">\n                    <InfoIconWrapper tooltip={tooltipMapper[interaction]}>\n                        <h2 className=\"text-2xl text-white pr-1 flex-grow\">{props.interaction}</h2>\n                    </InfoIconWrapper>\n                </div>\n                <SearchBar\n                    onKeyUp={(e) => updateFilter(e)}\n                    placeholder={`Search ${props.interaction}`}\n                    ariaLabel={`Search through all ${props.interaction}`}\n                />\n                <div className=\"w-2\"></div>\n                <button className=\"text-white bg-blue-500 cursor-pointer rounded-md p-2 h-9\" onClick={() => sortKeysInObject(interaction)}>\n                    {sortedIcon()}\n                </button>\n                <div className=\"w-2\"></div>\n                <button className=\"text-white font-bold text-sm bg-blue-500 cursor-pointer rounded-md p-2 h-9\" onClick={openCreatePropertyDialog}>Add</button>\n                {addInteractionDialog}\n            </div>\n            {buildChildren() && <div className=\"rounded-lg bg-gray-600 px-6 pt-4 pb-4\">{buildChildren()}</div>}\n        </>\n    );\n}","/********************************************************************************\n * Copyright (c) 2018 - 2021 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React, { useContext, useCallback, useState } from 'react';\nimport ediTDorContext from '../../context/ediTDorContext';\nimport \"../../assets/main.css\"\nimport { ChevronRight, ChevronDown } from 'react-feather';\nimport { getDirectedValue } from '../../util';\n\nfunction isObject(val) {\n    if (val === null) { return false; }\n    return ((typeof val === 'function') || (typeof val === 'object'));\n}\n\nexport const RenderedObject = (map) => {\n    const context = useContext(ediTDorContext);\n    const [showChildren, setShowChildren] = useState(new Array(Object.entries(map).length));\n    const handleClick = useCallback((i) => {\n        let temp = showChildren;\n        let x = showChildren[i];\n        temp[i] = x === null ? true : !x;\n        setShowChildren([...temp]);\n    }, [showChildren, setShowChildren])\n\n    return (\n        <>\n            {Object.entries(map).map(([k, v], i) => {\n                if (isObject(v)) {\n                    let indicator = (<button className=\"flex align-top\" onClick={() => handleClick(i)}>\n                        <div className=\"flex text-white font-bold bg-gray-600 py-1 px-2 rounded-md align-middle\">\n                            <h4>{k}</h4>\n                            {showChildren[i] === true ? <ChevronDown className=\"pl-1\" /> : <ChevronRight className=\"pl-1\" />}\n                        </div>\n                    </button>);\n\n                    let children = (<div className=\"flex\">\n                        <div className=\"flex w-1 rounded-lg bg-gray-400 ml-2 my-1\" />\n                        <div className=\"pl-8 mt-1\">\n                            {showChildren[i] === true && (Object.entries(v) ?? []).map(([k1, v1], i1) => {\n                                let m1 = {};\n                                m1[k1] = v1;\n                                return <RenderedObject {...m1} key={i1} />\n                            })}\n                        </div>\n                    </div>);\n\n                    return (\n                        <div className=\"mb-1\" key={i}>\n                            {indicator}\n                            {showChildren[i] === true && children}\n                        </div>\n                    )\n                }\n\n                const value = getDirectedValue(map, k,\n                    context.linkedTd[Object.keys(context.linkedTd)[0]]['@context']\n                );\n                return (\n                    <div className=\"flex mb-1\" key={i}>\n                        <h4 className=\"text-white font-bold bg-gray-600 py-1 px-2 rounded-md\">{k}</h4>\n                        <div className=\"text-gray-400 px-2 py-1\">{value}</div>\n                    </div>\n                )\n            })}\n        </ >\n    );\n}\n\n","/********************************************************************************\n * Copyright (c) 2018 - 2021 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React, { useContext, useEffect } from 'react';\nimport '../../assets/main.css';\nimport ediTDorContext from '../../context/ediTDorContext';\nimport { buildAttributeListObject, separateForms, changeBetweenTd, getDirectedValue } from '../../util';\nimport { AddFormDialog } from \"../Dialogs/AddFormDialog\";\nimport { AddLinkTdDialog } from '../Dialogs/AddLinkTdDialog';\nimport { InfoIconWrapper } from '../InfoIcon/InfoIcon';\nimport { getFormsTooltipContent } from '../InfoIcon/InfoTooltips';\nimport { getLinksTooltipContent } from '../InfoIcon/InfoTooltips';\nimport Form from './Form';\nimport Link from './Link';\nimport { InteractionSection } from './InteractionSection';\nimport { RenderedObject } from './RenderedObject';\nimport * as joint from 'jointjs';\n\nlet tdJSON = {};\nlet oldtdJSON = {};\nlet error = \"\";\n\nexport default function TDViewer() {\n    const context = useContext(ediTDorContext);\n\n    const addFormDialog = React.useRef();\n    const openAddFormDialog = () => { addFormDialog.current.openModal() }\n\n    const addLinkDialog = React.useRef();\n    const openAddLinkDialog = () => { addLinkDialog.current.openModal() }\n\n    const [graphHeight, setGraphHeight] = React.useState(() => { return 0 });\n    const [representationFormat, setRepresentationFormat] = React.useState(() => { return \"list\" });\n    const [isLinksOpen, setIsLinksOpen] = React.useState(() => { return false });\n\n\n\n    const representationFormatChange = (representationFormat) => {\n        setRepresentationFormat(representationFormat)\n    }\n\n\n    useEffect(() => {\n        if (document.getElementsByTagName(\"details\")[1]) {\n            document.getElementsByTagName(\"details\")[1].addEventListener(\"toggle\", function (evt) {\n                if (document.getElementsByTagName(\"details\")[1].attributes.open) {\n                    setIsLinksOpen(true);\n                }\n                else {\n                    setIsLinksOpen(false);\n\n                }\n            }, false);\n        }\n        let posx = 100;\n        let posy = 30;\n        // This graph is used to draw the thing description elements\n        let graphTd = new joint.dia.Graph();\n        let paperTd = new joint.dia.Paper({\n            el: document.getElementById('tdGraph'),\n            model: graphTd,\n            height: 270 + graphHeight,\n            width: 850,\n            gridSize: 10,\n            drawGrid: true,\n            restrictTranslate: true,\n        });\n        let offlineTD = {}\n        if (context.offlineTD) {\n            try {\n                offlineTD = JSON.parse(context.offlineTD);\n            } catch (e) {\n                let error = e.message;\n                console.error(error);\n            }\n        }\n        // Check if the links section exists to start drawing\n        //Update/refresh the content of the context.linkedTd whenever the the useEffect is triggered\n        if (offlineTD[\"links\"]) {\n            // Draw the links between Tds\n            var currentTdModel = new joint.shapes.standard.Rectangle();\n            currentTdModel.position(100, 10);\n            currentTdModel.resize(140, 40);\n            currentTdModel.attr({\n                body: {\n                    fill: '#005A9C'\n                },\n                label: {\n                    text: offlineTD[\"title\"],\n                    fill: 'white'\n                }\n            });\n            currentTdModel.set(\"td\", {});\n            currentTdModel.resize((currentTdModel.attributes.attrs[\"label\"][\"text\"].length) * 12, 40);\n            graphTd.addCell(currentTdModel);\n            for (let i = 0; i < offlineTD[\"links\"].length; i++) {\n                posx = posx + 70;\n                posy = posy + 60;\n                let href = offlineTD[\"links\"][i][\"href\"];\n                let targetTdModel = new joint.shapes.standard.Rectangle();\n                //Draw as many rectangles as there are links in the links section\n                targetTdModel.position(posx, posy);\n                targetTdModel.attr({\n                    body: {\n                        fill: '#005A9C'\n                    },\n                    label: {\n                        text: href,\n                        fill: 'white'\n                    }\n                });\n                targetTdModel.resize((targetTdModel.attributes.attrs[\"label\"][\"text\"].length) * 12, 40);\n                graphTd.addCell(targetTdModel);\n                targetTdModel.set(\"href\", href);\n                var removeButton = new joint.elementTools.Remove({\n                    useModelGeometry: true,\n                    y: '0%',\n                    x: '100%',\n                    action: async function (evt, elementView, buttonView) {\n                        if (context.linkedTd) {\n                            let currentLinkedTd = context.linkedTd;\n                            //update the linkedTd after removing the current linked Td\n                            if (currentLinkedTd[elementView.model.get(\"href\")]) {\n                                delete currentLinkedTd[elementView.model.get(\"href\")];\n                                context.updateLinkedTd(currentLinkedTd);\n                            }\n                        }\n                        for (let i = 0; i < offlineTD[\"links\"].length; i++) {\n                            if (offlineTD[\"links\"][i][\"href\"] === elementView.model.get(\"href\")) {\n                                context.removeLink(i);\n                                context.updateIsModified(true);\n                                break\n                            }\n                        }\n                    }\n                });\n                var toolsView = new joint.dia.ToolsView({\n                    tools: [removeButton]\n                });\n                var elementView = targetTdModel.findView(paperTd);\n                elementView.addTools(toolsView);\n                if (context.linkedTd && context.linkedTd[href] && (context.linkedTd[href][\"kind\"] === \"file\" || Object.keys(context.linkedTd[href]).length)) {\n                    targetTdModel.set(\"td\", context.linkedTd[href]);\n                    var infoButton = new joint.elementTools.Button({\n                        markup: [{\n                            tagName: 'circle',\n                            selector: 'button',\n                            attributes: {\n                                'r': 7,\n                                'fill': '#008FF5',\n                                'cursor': 'pointer'\n                            }\n                        }, {\n                            tagName: 'path',\n                            selector: 'icon',\n                            attributes: {\n                                'd': 'M -2 4 2 4 M 0 3 0 0 M -2 -1 1 -1 M -1 -4 1 -4',\n                                'fill': 'none',\n                                'stroke': '#FFFFFF',\n                                'stroke-width': 2,\n                                'pointer-events': 'none'\n                            }\n                        }],\n                        x: '0%',\n                        y: '0%',\n                        rotate: true,\n                        action: async function (evt, elementView, buttonView) {\n                            let href = elementView.model.get(\"href\");\n                            changeBetweenTd(context, href);\n                        }\n                    });\n                    let toolsView = new joint.dia.ToolsView({\n                        tools: [removeButton, infoButton]\n                    });\n                    elementView.addTools(toolsView);\n                }\n                let link = new joint.shapes.standard.Link(\n                    {\n                        attrs: {\n                            line: {\n                                'stroke': '#005A9C'\n                            }\n                        },\n                        labels: [{\n                            position: .6,\n                            attrs: {\n                                text: {\n                                    text: offlineTD[\"links\"][i][\"rel\"] === undefined ? \"\" : offlineTD[\"links\"][i][\"rel\"],\n                                    fill: 'grey'\n                                }\n                            }\n                        }]\n                    }\n                )\n                link.source(currentTdModel);\n                link.target(targetTdModel);\n                link.addTo(graphTd);\n            }\n            setGraphHeight(posy + 30);\n        }\n    }, [graphHeight, representationFormat, context]);\n\n    try {\n        oldtdJSON = tdJSON;\n        tdJSON = JSON.parse(context.offlineTD);\n        error = '';\n    } catch (e) {\n        error = e.message;\n        tdJSON = oldtdJSON;\n    }\n\n\n    if (!Object.keys(tdJSON).length) {\n        return (\n            <div className=\"flex h-full w-full bg-gray-500 justify-center align-center text-center \">\n                <div className=\"text-4xl text-white place-self-center\">Start writing a new TD by clicking \"New TD\"</div>\n            </div>\n        )\n    }\n\n    let forms;\n    let links;\n    let metaData;\n\n    if (tdJSON) {\n        if (tdJSON.forms) {\n            const formsSeparated = separateForms(tdJSON.forms);\n            forms = formsSeparated.map((key, index) => {\n                return (<Form form={key} propName={index} key={index} />);\n            });\n        }\n        if (tdJSON.links) {\n            const linksfromTd = tdJSON.links;\n            links = linksfromTd.map((key, index) => {\n                return (<Link link={key} propName={index} key={index} />);\n            });\n        }\n\n        metaData = tdJSON;\n\n        const alreadyRenderedKeys = [\"id\", \"properties\", \"actions\", \"events\", \"forms\", \"description\", \"title\", \"links\"];\n        const attributeListObject = buildAttributeListObject(tdJSON.id ? { id: tdJSON.id } : {}, tdJSON, alreadyRenderedKeys);\n\n        return (\n            <div className=\"h-full w-full bg-gray-500 p-8 overflow-auto\">\n                {(error.length > 0 && (\n                    <div className=\"flex h-10 w-full bg-formRed rounded-md px-4 mt-2 bg-opacity-75 border-2 border-formRed\">\n                        <div className=\"flex h-6 w-16 bg-white rounded-md place-self-center justify-center\">\n                            <div className=\"text-formRed place-self-center text-center text-xs px-4\">Error</div>\n                        </div>\n                        <div className=\" place-self-center pl-3 text-base text-white overflow-hidden\">{error}</div>\n                    </div>))}\n                {(metaData !== undefined && Object.keys(metaData).length > 0) && (\n                    <div>\n                        <div className=\"text-3xl text-white\">{getDirectedValue(metaData, 'title', metaData['@context'])}</div>\n                        <RenderedObject {...attributeListObject}></RenderedObject>\n                        {\n                            metaData.description ? <div className=\"text-xl text-white pt-4\">{getDirectedValue(metaData, 'description', metaData['@context'])}</div> : <></>\n                        }\n                    </div>)\n                }\n                <details className=\"pt-8\">\n                    <summary className=\"flex justify-start items-center cursor-pointer\">\n                        <div className=\"flex flex-grow\">\n                            <InfoIconWrapper tooltip={getFormsTooltipContent()}>\n                                <h2 className=\"text-2xl text-white p-1 flex-grow\">Forms</h2>\n                            </InfoIconWrapper>\n                        </div>\n                        <button className=\"text-white font-bold text-sm bg-blue-500 cursor-pointer rounded-md p-2\" onClick={openAddFormDialog}>Add Top Level Form</button>\n                        <AddFormDialog type=\"thing\"\n                            interaction={tdJSON}\n                            ref={addFormDialog}\n                        />\n                    </summary>\n                    {forms && <div className=\"pt-4\"><div className=\"rounded-lg bg-gray-600 px-6 pt-4 pb-4\">{forms}</div></div>}\n                </details>\n\n                <details className=\"pt-8\">\n                    <summary className=\"flex justify-start items-center cursor-pointer\">\n                        <div className=\"flex flex-grow\">\n                            <InfoIconWrapper tooltip={getLinksTooltipContent()}>\n                                <h2 className=\"text-2xl text-white p-1 flex-grow\">Links</h2>\n                            </InfoIconWrapper>\n\n                            {isLinksOpen && <button className=\"text-white font-bold text-sm bg-blue-500 cursor-pointer rounded-md p-2 h-9\" disabled={representationFormat === \"list\"} onClick={() => representationFormatChange(\"list\")}>List</button>}\n                            {isLinksOpen && <button className=\"text-white font-bold text-sm bg-blue-500 cursor-pointer rounded-md p-2 h-9\" style={{ marginLeft: \"10px\" }} disabled={representationFormat === \"graph\"} onClick={() => representationFormatChange(\"graph\")}>Graph</button>}\n                        </div>\n                        <button className=\"text-white font-bold text-sm bg-blue-500 cursor-pointer rounded-md p-2\" onClick={openAddLinkDialog}>Add Top Level Link</button>\n                        <AddLinkTdDialog type=\"link\"\n                            interaction={tdJSON}\n                            ref={addLinkDialog}\n                        />\n                    </summary>\n                    {links && representationFormat === \"graph\" && <div className=\"pt-4\"><div className=\"rounded-lg bg-gray-600 px-6 pt-4 pb-4\" id=\"tdGraph\"></div></div>}\n                    {links && representationFormat === \"list\" && <div className=\"pt-4\"><div className=\"rounded-lg bg-gray-600 px-6 pt-4 pb-4\">{links}</div></div>}\n\n                </details>\n\n                <InteractionSection interaction=\"Properties\" ></InteractionSection>\n                <InteractionSection interaction=\"Actions\" ></InteractionSection>\n                <InteractionSection interaction=\"Events\" ></InteractionSection>\n            </div >\n        );\n    }\n}\n","/********************************************************************************\n * Copyright (c) 2018 - 2020 Contributors to the Eclipse Foundation\n *\n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n *\n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React, { useContext, useState, useRef, useEffect } from \"react\";\nimport MonacoEditor from \"react-monaco-editor\";\nimport ediTDorContext from \"../../context/ediTDorContext\";\nimport { changeBetweenTd } from '../../util';\n\nconst mapping = require(\"../../assets/mapping.json\");\n\nconst tdSchema =\n  \"https://raw.githubusercontent.com/thingweb/thingweb-playground/%40thing-description-playground/web%401.0.0/packages/playground-core/td-schema.json\";\nconst tmSchema =\n  \"https://raw.githubusercontent.com/w3c/wot-thing-description/main/validation/tm-json-schema-validation.json\";\n\n//List of all Options can be found here: https://microsoft.github.io/monaco-editor/api/interfaces/monaco.editor.ieditorconstructionoptions.html\nconst editorOptions = {\n  selectOnLineNumbers: true,\n  automaticLayout: true,\n  lineDecorationsWidth: 20,\n};\n\nconst JSONEditorComponent = (props) => {\n  const context = useContext(ediTDorContext);\n  const [schemas] = useState([]);\n  const [proxy, setProxy] = useState(undefined);\n  const editorInstance = useRef(null);\n  const [tabs, setTabs] = useState([]);\n\n  const editorWillMount = async (monaco) => {\n    monaco.languages.json.jsonDefaults.setDiagnosticsOptions({\n      validate: true,\n      enableSchemaRequest: true,\n      schemas: [],\n    });\n\n    if (!(\"Proxy\" in window)) {\n      console.warn(\"Your browser doesn't support Proxies.\");\n      return;\n    }\n\n    let proxy = new Proxy(schemas, {\n      set: function (target, property, value, _) {\n        target[property] = value;\n\n        let jsonSchemaObjects = [tdSchema];\n        for (let i = 0; i < target.length; i++) {\n          jsonSchemaObjects.push({\n            fileMatch: [\"*/*\"],\n            uri: target[i],\n          });\n        }\n\n        monaco.languages.json.jsonDefaults.setDiagnosticsOptions({\n          validate: true,\n          enableSchemaRequest: true,\n          schemas: jsonSchemaObjects,\n        });\n\n        return true;\n      },\n    });\n    setProxy(proxy);\n  };\n\n  const editorDidMount = (editor, monaco) => {\n    editor.onDidChangeModelDecorations(() => {\n      const model = editor.getModel();\n      if (model === null || model.getModeId() !== \"json\") return;\n    });\n  };\n\n  const addSchema = (val) => {\n    if (proxy.includes(val)) {\n      return;\n    }\n    proxy.push(val);\n  };\n\n  const removeSchema = (val) => {\n    const index = proxy.indexOf(val);\n    if (index === -1) {\n      return;\n    }\n    proxy.splice(index, 1);\n  };\n\n  const emptySchemas = () => {\n    proxy.splice(0, this.state.proxy.length);\n  };\n\n  const fetchSchema = async (target) => {\n    if (proxy.includes(target)) {\n      return;\n    }\n\n    try {\n      const url = new URL(target);\n      const res = await fetch(url);\n\n      const schema = await res.json();\n      return schema;\n    } catch (e) {\n      console.error(e);\n    }\n  };\n\n  const onChange = async (editorText, _) => {\n    try {\n      const json = JSON.parse(editorText);\n      if (!(\"@context\" in json)) {\n        emptySchemas();\n        return;\n      }\n      //Initialize TD-Schema\n      if (context.isThingModel === undefined) {\n        context.updateIsThingModel(false);\n        const schema = await fetchSchema(tdSchema);\n        if (schema) {\n          addSchema(tdSchema);\n        }\n      }\n\n      const atContext = json[\"@context\"];\n      const atType = json[\"@type\"];\n      if (atType && atType.indexOf(\"ThingModel\") > -1) {\n        if (!context.isThingModel) {\n          context.updateIsThingModel(true);\n          const schema = await fetchSchema(tmSchema);\n          if (schema) {\n            addSchema(tmSchema);\n            removeSchema(tdSchema);\n          }\n        }\n      } else if (context.isThingModel) {\n        if (\n          JSON.stringify(atContext).indexOf(\n            \"https://www.w3.org/2019/wot/td/v1\"\n          ) > -1\n        ) {\n          context.updateIsThingModel(false);\n          const schema = await fetchSchema(tdSchema);\n          if (schema) {\n            addSchema(tdSchema);\n            removeSchema(tmSchema);\n          }\n        }\n      }\n\n      // handle if @context is a string\n      if (typeof atContext === \"string\") {\n        if (mapping[atContext] !== undefined && !proxy.includes(mapping[atContext])) {\n          const schema = await fetchSchema(atContext);\n          if (schema) {\n            addSchema(atContext);\n          }\n          return;\n        }\n      }\n\n      // handle if @context is an array\n      if (Array.isArray(atContext)) {\n        for (let i = 0; i < atContext.length; i++) {\n          if (typeof atContext[i] === \"string\") {\n            if (mapping[atContext] !== undefined && !proxy.includes(mapping[atContext])) {\n              console.log(\"found schema for\", atContext);\n              const schema = await fetchSchema(atContext[i]);\n              if (schema) {\n                addSchema(atContext[i]);\n              }\n            }\n          }\n          if (typeof atContext[i] === \"object\") {\n            Object.keys(atContext[i]).forEach(async (contextKey) => {\n              if (mapping[atContext[i][contextKey]] !== undefined && !proxy.includes(mapping[atContext])) {\n                const schema = await fetchSchema(mapping[atContext[i][contextKey]]);\n                if (schema) {\n                  addSchema(mapping[atContext[i][contextKey]]);\n                }\n              }\n            });\n          }\n        }\n      }\n      // remove deleted schemas\n      if (Array.isArray(atContext)) {\n        for (let i = 0; i < proxy.length; i++) {\n          const x = Object.keys(mapping).find(\n            (key) => mapping[key] === proxy[i]\n          );\n          if (!atContext.includes(x)) {\n            removeSchema(proxy[i]);\n          }\n        }\n      }\n    } catch (e) {\n    } finally {\n      context.updateOfflineTD(editorText, \"Editor\");\n    }\n  };\n\n  useEffect(() => {\n    async function getTabs() {\n      try {\n        if (context.linkedTd) {\n          let tabs = [];\n          let index = 0;\n          for (let key in context.linkedTd) {\n            if (context.linkedTd[key][\"kind\"] === \"file\" || Object.keys(context.linkedTd[key]).length) {\n              tabs.push(<option value={key} key={index}>{key}</option>);\n              index++;\n            }\n          }\n          setTabs(tabs);\n        }\n      } catch (err) {\n        console.error(err);\n      }\n    }\n    getTabs();\n  }, [context.linkedTd, context.offlineTD]);\n\n  const changeLinkedTd = async () => {\n    let href = document.getElementById(\"linkedTd\").value;\n    changeBetweenTd(context, href);\n  }\n  return (\n    <>\n      <div id=\"tabsBackground\" >\n        {\n          context.offlineTD && context.linkedTd &&\n          <select name=\"linkedTd\" id=\"linkedTd\" className=\"text-white\" onChange={() => changeLinkedTd()}>\n            {tabs}\n          </select>\n        }\n      </div>\n      <div className=\"w-full h-full\" id=\"editor\">\n        <MonacoEditor\n          options={editorOptions}\n          theme={\"vs-\" + context.theme}\n          language=\"json\"\n          ref={editorInstance}\n          value={context.offlineTD}\n          editorWillMount={editorWillMount}\n          editorDidMount={editorDidMount}\n          onChange={async (editorText) => {\n            await onChange(editorText);\n          }}\n        />\n      </div>\n    </>\n\n  );\n};\n\nexport default JSONEditorComponent;","/********************************************************************************\n * Copyright (c) 2018 - 2020 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React from 'react';\n\nexport default function Button(props) {\n    return (\n        <button\n            onClick={props.onClick}\n            className=\"\n                flex\n                bg-blue-400                 \n                hover:bg-blue-300 \n                text-white \n                font-bold \n                py-2 px-5 \n                rounded \n                h-12\n                text-center \n                cursor-pointer\n                justify-center\n            \">\n            <div className=\"place-self-center\">\n                {props.children}\n            </div>\n        </button>\n    );\n}","/********************************************************************************\n * Copyright (c) 2018 - 2021 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React, { forwardRef, useContext, useEffect, useImperativeHandle } from 'react';\nimport ReactDOM from \"react-dom\";\nimport ediTDorContext from \"../../context/ediTDorContext\";\nimport { DialogTemplate } from \"./DialogTemplate\";\n\nexport const ShareDialog = forwardRef((props, ref) => {\n    const context = useContext(ediTDorContext);\n    const [display, setDisplay] = React.useState(() => { return false });\n\n    useEffect(() => {\n        if (display === true) {\n            copyLinkToClipboard(createPermalink(context.offlineTD));\n            focusPermalinkField()\n        }\n    }, [display, context]);\n\n    useImperativeHandle(ref, () => {\n        return {\n            openModal: () => open(),\n            close: () => close()\n        }\n    });\n\n    const open = () => {\n        setDisplay(true)\n    };\n\n    const close = () => {\n        setDisplay(false);\n    };\n\n    const urlField = createPermalinkField(context.offlineTD);\n\n    if (display) {\n        return ReactDOM.createPortal(\n            <DialogTemplate\n                onCancel={close}\n                cancelText={\"Close\"}\n                hasSubmit={false}\n                children={urlField}\n                title={\"Share This TD\"}\n                description={\"A link to this TD was copied to your clipboard.\"}\n            />,\n            document.getElementById(\"modal-root\"));\n    }\n\n    return null;\n});\n\nconst createPermalink = (td) => {\n    let parsedTD = {};\n    try {\n        parsedTD = JSON.parse(td);\n    } catch (_) { }\n\n    return `${window.location.origin+window.location.pathname}?td=${encodeURIComponent(\n        JSON.stringify(parsedTD)\n    )}`;\n}\n\nconst createPermalinkField = (td) => {\n    return (<input\n        type=\"text\"\n        name=\"share-td-field\"\n        id=\"share-td-field\"\n        className=\"border-gray-600 bg-gray-600 w-full p-2 sm:text-sm border-2 text-white rounded-md focus:outline-none focus:border-blue-500\"\n        defaultValue={createPermalink(td)}\n    />);\n};\n\nconst copyLinkToClipboard = (link) => {\n    if (document.hasFocus()) {\n        navigator.clipboard.writeText(link).then(\n            function () {\n                console.log(\"Async: Copied TD link to clipboard!\");\n            },\n            function (err) {\n                console.error(\"Async: Could not copy TD to clipboard: \", err);\n            }\n        );\n    }\n}\n\nconst focusPermalinkField = () => {\n    setTimeout(() => {\n        try {\n            const textfield = document.getElementById(\"share-td-field\");\n            textfield.select();\n        } catch (_) { }\n    }, 250);\n}","/********************************************************************************\n * Copyright (c) 2018 - 2021 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React, { forwardRef, useContext, useEffect, useImperativeHandle } from 'react';\nimport ReactDOM from \"react-dom\";\nimport ediTDorContext from \"../../context/ediTDorContext\";\nimport { DialogTemplate } from \"./DialogTemplate\";\n\nexport const ConvertTmDialog = forwardRef((props, ref) => {\n    const context = useContext(ediTDorContext);\n    const [htmlInputs, setHtmlInputs] = React.useState([]);\n    const [display, setDisplay] = React.useState(() => { return false });\n\n    useEffect(() => {\n        setHtmlInputs(createHtmlInputs(context.offlineTD));\n    }, [context]);\n\n    useImperativeHandle(ref, () => {\n        return {\n            openModal: () => open(),\n            close: () => close()\n        }\n    });\n\n    const open = () => {\n        setDisplay(true)\n    };\n\n    const close = () => {\n        setDisplay(false);\n    };\n\n    if (display) {\n        return ReactDOM.createPortal(\n            <DialogTemplate\n                onCancel={close}\n                onSubmit={() => convertTmToTd(context.offlineTD, htmlInputs)}\n                submitText={\"Generate TD\"}\n                children={htmlInputs}\n                title={\"Generate TD From TM\"}\n                description={\"Please provide values to switch the placeholders with.\"}\n            />,\n            document.getElementById(\"modal-root\"));\n    }\n\n    return null;\n});\n\n\nconst createHtmlInputs = (td) => {\n    try {\n        let regex = /{{/gi,\n            result,\n            startIindices = [];\n        while ((result = regex.exec(td))) {\n            startIindices.push(result.index);\n        }\n        regex = /}}/gi;\n        let endIndices = [];\n        while ((result = regex.exec(td))) {\n            endIndices.push(result.index);\n        }\n        let placeholders = [];\n        for (let i = 0; i < startIindices.length; i++) {\n            placeholders.push(td.slice(startIindices[i] + 2, endIndices[i]));\n        }\n        placeholders = [...new Set(placeholders)];\n        const htmlInputs = placeholders.map((holder) => {\n            return (\n                <div key={holder} className=\"py-1\">\n                    <label htmlFor={holder} className=\"text-sm text-gray-400 font-medium pl-2\">{holder}:</label>\n                    <input\n                        type=\"text\"\n                        name={holder}\n                        id={holder}\n                        className=\"border-gray-600 bg-gray-600 w-full p-2 sm:text-sm border-2 text-white rounded-md focus:outline-none focus:border-blue-500\"\n                        placeholder=\"Enter a value...\"\n                    />\n                </div>\n            );\n        });\n\n        // Containers for created html elements (checkboxes) of each interaction affordance\n        let htmlProperties = [];\n        let htmlActions = [];\n        let htmlEvents = [];\n\n        try {\n            const parsed = JSON.parse(td);\n            const properties = Object.keys(parsed[\"properties\"] ? parsed[\"properties\"] : {});\n            const actions = Object.keys(parsed[\"actions\"] ? parsed[\"actions\"] : {});\n            const events = Object.keys(parsed[\"events\"] ? parsed[\"events\"] : {});\n            const requiredFields = {\"properties\": [], \"actions\": [], \"events\": []};\n\n            // Parse the required interaction affordances\n            if (parsed[\"tm:required\"]) {\n                for (const field of parsed[\"tm:required\"]) {\n                    if (field.startsWith(\"#properties/\"))\n                        requiredFields[\"properties\"].push(field.split(\"/\")[1]);\n                    else if (field.startsWith(\"#actions/\"))\n                        requiredFields[\"actions\"].push(field.split(\"/\")[1]);\n                    else if (field.startsWith(\"#events/\"))\n                        requiredFields[\"events\"].push(field.split(\"/\")[1]);\n                }\n            }\n\n            // Create html (checkboxes) for specific interaction affordances\n            function createAffordanceHtml(affName, affContainer) {\n                return affContainer.map((aff) => {\n                    const required = requiredFields[affName].includes(aff);\n                    return (\n                        <div key={`${affName}/${aff}`} className=\"form-checkbox py-1 pl-2\">\n                            <input id={`${affName}/${aff}`}\n                                className=\"form-checkbox-input\"\n                                type=\"checkbox\"\n                                value={`#${affName}/${aff}`}\n                                disabled={required}\n                                defaultChecked={true}\n                                title={required ? \"This field is required by the TM.\" : \"\"}\n                                data-interaction={affName}\n                            />\n                            <label className=\"form-checkbox-label pl-2\" htmlFor={`${affName}/${aff}`}>{`#${affName}/${aff}`}</label>\n                        </div>\n                    );\n                });\n            };\n\n            htmlProperties = createAffordanceHtml(\"properties\", properties);\n            htmlActions = createAffordanceHtml(\"actions\", actions);\n            htmlEvents = createAffordanceHtml(\"events\", events);\n\n        } catch (ignored) {}\n\n        const divider = (\n            <h2 key=\"modalDividerText\" className=\"text-gray-400 pb-2 pt-4\">\n                {\"Also, select/unselect the interaction affordances you would like to see in the new TD.\"}\n            </h2>\n        );\n\n        return [...htmlInputs, divider, ...htmlProperties, ...htmlActions, ...htmlEvents];\n    } catch (e) {\n        console.log(e);\n        return [];\n    }\n};\n\nconst convertTmToTd = (td, htmlInputs) => {\n    let mappingObject = {}\n    const properties = [];\n    const actions = [];\n    const events = [];\n\n    // Process the ticked affordances and save them in respective arrays\n    for (const item of htmlInputs) {\n        if (item.props.className.indexOf(\"form-checkbox\") > -1 &&\n        document.getElementById(item.props.children[0].props.id).checked) {\n            if (item.props.children[0].props[\"data-interaction\"] === \"properties\")\n                properties.push(item[\"key\"].split(\"/\")[1]);\n            else if (item.props.children[0].props[\"data-interaction\"] === \"actions\")\n                actions.push(item[\"key\"].split(\"/\")[1]);\n            else if (item.props.children[0].props[\"data-interaction\"] === \"events\")\n                events.push(item[\"key\"].split(\"/\")[1]);\n        }\n    }\n\n    // Process the placeholders\n    htmlInputs = htmlInputs.filter((e) => {\n        return e.props.className.indexOf(\"form-checkbox\") === -1 && e.key !== \"modalDividerText\";\n    });\n    htmlInputs.forEach((y) => {\n        const elem = document.getElementById(y.key)\n        mappingObject[y.key] = elem.value\n        return elem.value\n    });\n    Object.keys(mappingObject).forEach(key => {\n        td = td.split(`{{${key}}}`).join(mappingObject[key])\n    })\n    const parse = JSON.parse(td);\n\n    // Create new affordances by leaving only the ticked ones\n    if (parse[\"properties\"]) {\n        const newProperties = Object.keys(parse[\"properties\"])\n            .filter(key => properties.includes(key))\n            .reduce((obj, key) => {\n                obj[key] = parse[\"properties\"][key];\n                return obj;\n            }, {});\n\n        // Adapt the new TD\n        parse[\"properties\"] = newProperties;\n    }\n\n    if (parse[\"actions\"]) {\n        const newActions = Object.keys(parse[\"actions\"])\n            .filter(key => actions.includes(key))\n            .reduce((obj, key) => {\n                obj[key] = parse[\"actions\"][key];\n                return obj;\n            }, {});\n\n        // Adapt the new TD\n        parse[\"actions\"] = newActions;\n    }\n\n    if (parse[\"events\"]) {\n        const newEvents = Object.keys(parse[\"events\"])\n            .filter(key => events.includes(key))\n            .reduce((obj, key) => {\n                obj[key] = parse[\"events\"][key];\n                return obj;\n            }, {});\n\n        // Adapt the new TD\n        parse[\"events\"] = newEvents;\n    }\n\n    // Remove TM related data\n    delete parse[\"@type\"];\n    delete parse[\"tm:required\"];\n\n    let permalink = `${window.location.origin+window.location.pathname}?td=${encodeURIComponent(JSON.stringify(parse))}`;\n    window.open(permalink, \"_blank\");\n}\n","/********************************************************************************\n * Copyright (c) 2018 - 2021 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React, { forwardRef, useImperativeHandle, useContext } from 'react';\nimport ReactDOM from \"react-dom\";\nimport { DialogTemplate } from \"./DialogTemplate\";\nimport ediTDorContext from '../../context/ediTDorContext';\nimport { ChevronDown } from 'react-feather';\n\nexport const CreateTdDialog = forwardRef((props, ref) => {\n    const context = useContext(ediTDorContext);\n    const [display, setDisplay] = React.useState(() => { return false });\n    const [type, setType] = React.useState(\"TD\");  // either TD or TM\n\n    useImperativeHandle(ref, () => {\n        return {\n            openModal: () => open(),\n            close: () => close()\n        }\n    });\n\n    const open = () => {\n        setDisplay(true)\n    };\n\n    const close = () => {\n        setDisplay(false);\n    };\n\n    const changeType = (e) => {\n        setType(e.target.value);\n    }\n\n    const getType = () => {\n        return type;\n    }\n\n    const content = buildForm(changeType, getType);\n\n    if (display) {\n        return ReactDOM.createPortal(\n            <DialogTemplate\n                onCancel={close}\n                onSubmit={() => {\n                    let td=createNewTD(type)\n                    let linkedTd={}\n                    linkedTd[td[\"title\"]]=td\n                    context.updateLinkedTd(undefined)\n                    context.addLinkedTd(linkedTd)\n                    context.updateShowConvertBtn(type === \"TM\");\n                    context.updateOfflineTD(JSON.stringify(td, null, \"\\t\"),\"AppHeader\");\n                    close();\n                }}\n                children={content}\n                submitText={type === \"TD\" ? \"Create TD\" : \"Create TM\"}\n                title={\"Create a New TD/TM\"}\n                description={\"To quickly create a basis for your new Thing Description/Thing Model just fill out this little template and we'll get you going.\"}\n            />,\n            document.getElementById(\"modal-root\"));\n    }\n\n    return null;\n});\n\nconst buildForm = (changeType, getType) => {\n    return <>\n        <label htmlFor=\"type\" className=\"text-sm text-gray-400 font-medium pl-2\">Type:</label>\n        <div className=\"relative\">\n            <select className=\"block appearance-none w-full bg-gray-600 border-2 border-gray-600 text-white py-3 px-4 pr-8 rounded leading-tight focus:border-blue-500 focus:outline-none\" id=\"type\" onChange={changeType} value={getType()}>\n                <option value=\"TD\">Thing Description</option>\n                <option value=\"TM\">Thing Model</option>\n            </select>\n            <div className=\"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700\">\n                <ChevronDown color=\"#cacaca\"></ChevronDown>\n            </div>\n        </div>\n        {formField(\"ID\", \"urn:thing-id\", \"thing-id\", \"url\", \"autoFocus\")}\n        {formField(\"Title\", \"Thing Title\", \"thing-title\", \"text\")}\n        {formField(\"Base\", \"http://www.example.com/thing-path\", \"thing-base\", \"url\")}\n        <label htmlFor=\"thing-description\" className=\"text-sm text-gray-400 font-medium pl-2\">Description:</label>\n        <textarea id=\"thing-description\" rows=\"5\"\n            className=\"bg-gray-600\n                sm:text-sm\n                appearance-none \n                border-2 border-gray-600 rounded w-full \n                p-2\n                text-white \n                leading-tight \n                focus:outline-none \n                focus:border-blue-500\"\n            placeholder=\"A short description about this new Thing...\" />\n        <label htmlFor=\"thing-security\" className=\"text-sm text-gray-400 font-medium pl-2\">Security:</label>\n        <div className=\"relative\">\n            <select className=\"block appearance-none w-full bg-gray-600 border-2 border-gray-600 text-white py-3 px-4 pr-8 rounded leading-tight focus:border-blue-500 focus:outline-none\" id=\"thing-security\">\n                <option>nosec</option>\n                <option>basic</option>\n                <option>digest</option>\n                <option>bearer</option>\n                <option>psk</option>\n                <option>oauth2</option>\n                <option>apikey</option>\n            </select>\n            <div className=\"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700\">\n                <ChevronDown color=\"#cacaca\"></ChevronDown>\n            </div>\n        </div>\n    </>;\n}\n\nconst formField = (label, placeholder, id, type, autoFocus) => {\n    return <div key={id} className=\"py-1\">\n        <label htmlFor={id} className=\"text-sm text-gray-400 font-medium pl-2\">{label}:</label>\n        <input\n            name={id}\n            id={id}\n            className=\"border-gray-600 bg-gray-600 w-full p-2 sm:text-sm border-2 text-white rounded-md focus:outline-none focus:border-blue-500\"\n            placeholder={placeholder}\n            type={type}\n            autoFocus={autoFocus === 'autoFocus'}\n        />\n    </div>;\n}\n\nconst createNewTD = (type) => {   \n    let id = document.getElementById('thing-id').value;\n    let title = document.getElementById('thing-title').value;\n    let base = document.getElementById('thing-base').value;\n\n    let tdDescription = document.getElementById('thing-description').value;\n    let tdSecurity = document.getElementById('thing-security').value;\n\n    var thing = {};\n\n    thing[\"@context\"] = \"https://www.w3.org/2019/wot/td/v1\";\n    thing[\"title\"] = title !== \"\" ? title : \"ediTDor Thing\";\n\n    if (type === \"TM\") {\n        thing[\"@type\"] = \"tm:ThingModel\";\n    }\n\n    if (id !== \"\") {\n        thing[\"id\"] = id !== \"\" ? id : \"urn:editdor-thing-id\";\n    }\n\n    if (base !== \"\") {\n        thing[\"base\"] = base !== \"\" ? base : \"/\";\n    }\n\n    if (tdDescription !== \"\") {\n        thing[\"description\"] = tdDescription;\n    }\n\n    let securityDefinitions = {};\n    securityDefinitions[`${tdSecurity}_sc`] = { scheme: tdSecurity };\n\n    thing[\"securityDefinitions\"] = securityDefinitions;\n    thing[\"security\"] = `${tdSecurity}_sc`;\n\n    thing[\"properties\"] = {};\n    thing[\"actions\"] = {};\n    thing[\"events\"] = {};\n\n    return thing;\n}","/********************************************************************************\n * Copyright (c) 2018 - 2020 Contributors to the Eclipse Foundation\n *\n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n *\n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React, { useCallback, useContext, useEffect } from \"react\";\nimport logo from \"../../../assets/editdor.png\";\nimport wot from \"../../../assets/WoT.png\";\nimport ediTDorContext from \"../../../context/ediTDorContext\";\nimport \"../../../assets/main.css\";\nimport \"../App.css\"\nimport Button from \"./Button\";\nimport { ShareDialog } from \"../../Dialogs/ShareDialog\";\nimport { ConvertTmDialog } from \"../../Dialogs/ConvertTmDialog\";\nimport { CreateTdDialog } from \"../../Dialogs/CreateTdDialog\";\nimport { getFileHandle, getFileHTML5, _readFileHTML5 } from \"../../../util.js\";\n\n\nexport default function AppHeader() {\n  const context = useContext(ediTDorContext);\n  /**\n   * Check if the Browser Supports the new Native File System Api (Chromium 86.0)\n   */\n  const hasNativeFS = useCallback(() => {\n    return (\n      \"chooseFileSystemEntries\" in window || \"showOpenFilePicker\" in window\n    );\n  }, []);\n\n  const verifyDiscard = useCallback(async () => {\n    if (!context.isModified) {\n      return true;\n    }\n    const msg =\n      \"Discard changes? All changes you made to your TD will be lost.\";\n    return await window.confirm(msg);\n  }, [context.isModified]);\n\n  /**\n   *\n   * @param {*} file\n   *\n   * Read file content\n   */\n  const read = useCallback((file) => {\n    return file.text ? file.text() : _readFileHTML5(file);\n  }, []);\n\n  const readFile = useCallback(\n    async (file, fileHandle) => {\n      try {\n        let td = await read(file)\n        let linkedTd = {}\n        if (fileHandle !== undefined) {\n          linkedTd[\"./\" + file.name] = fileHandle;\n        }\n        else {\n          linkedTd[\"./\" + file.name] = JSON.parse(td);\n        }\n        context.updateLinkedTd(undefined);\n        context.addLinkedTd(linkedTd);\n        context.updateOfflineTD(td);\n        context.setFileHandle(fileHandle || file.name);\n        context.updateIsModified(false);\n      } catch (ex) {\n        const msg = `An error occured reading ${context.offlineTD}`;\n        console.error(msg, ex);\n        //TODO: Replace with custom alert\n        alert(msg);\n      }\n    },\n    [context, read]\n  );\n\n  /**\n   *\n   * @param {*} _\n   *\n   * Open File from Filesystem\n   */\n  const openFile = useCallback(\n    async (_) => {\n      if (!(await verifyDiscard())) {\n        return;\n      }\n\n      if (!hasNativeFS()) {\n        const file = await getFileHTML5();\n        if (file) {\n          await readFile(file);\n        }\n        return;\n      }\n      let fileHandle;\n      try {\n        fileHandle = await getFileHandle();\n        const file = await fileHandle.getFile();\n        await readFile(file, fileHandle);\n      } catch (ex) {\n        const msg = \"We ran into an error trying to open your TD.\";\n        console.error(msg, ex);\n        alert(msg);\n      }\n    },\n    [readFile, verifyDiscard, hasNativeFS]\n  );\n\n  const writeFile = useCallback(\n    async (fileHandle, contents) => {\n      if (fileHandle.createWriter) {\n        const writer = await fileHandle.createWriter();\n        await writer.write(0, contents);\n        await writer.close();\n        return;\n      }\n\n      const writable = await fileHandle.createWritable();\n      await writable.write(contents);\n      await writable.close();\n\n      // refresh td for rendered view\n      setTimeout(() => {\n        context.updateOfflineTD(contents, \"AppHEader\");\n        context.updateIsModified(false);\n      }, 500);\n    },\n    [context]\n  );\n\n  const saveAsHTML5 = useCallback((filename, contents) => {\n    const aDownload = document.getElementById(\"aDownload\");\n    let tdJSON = {}\n    let tdTitle\n    try {\n      tdJSON = JSON.parse(contents);\n      tdTitle = tdJSON[\"id\"] || tdJSON[\"title\"]\n      tdTitle = tdTitle.replace(/\\s/g, \"\") + \".jsonld\"\n    } catch (e) {\n      console.error(e);\n    }\n    filename = filename || tdTitle;\n    const opts = { type: \"application/ld+json\" };\n    const file = new File([contents], \"\", opts);\n    aDownload.href = window.URL.createObjectURL(file);\n    aDownload.setAttribute(\"download\", filename);\n    aDownload.click();\n  }, []);\n\n  const saveFileAs = useCallback(async () => {\n    if (!hasNativeFS()) {\n      saveAsHTML5(context.name, context.offlineTD);\n      return;\n    }\n\n    let fileHandle;\n    try {\n      fileHandle = await getNewFileHandle();\n    } catch (ex) {\n      const msg = \"We ran into an error trying to save your TD.\";\n      console.error(msg, ex);\n      return alert(msg);\n    }\n\n    try {\n      await writeFile(fileHandle, context.offlineTD);\n      if (document.getElementById(\"linkedTd\")) {\n        let href = document.getElementById(\"linkedTd\").value;\n        if (typeof context.fileHandle !== \"object\") {\n          let linkedTd = context.linkedTd;\n          linkedTd[href] = fileHandle;\n          context.updateLinkedTd(linkedTd);\n        }\n      }\n      context.setFileHandle(fileHandle);\n      context.updateIsModified(false);\n    } catch (ex) {\n      const msg = \"Unfortunately we were unable to save your TD.\";\n      console.error(msg, ex);\n      alert(msg);\n    }\n  }, [saveAsHTML5, hasNativeFS, context, writeFile]);\n\n  const saveFile = useCallback(async () => {\n    try {\n      if (!context.fileHandle) {\n        return await saveFileAs();\n      }\n      await writeFile(context.fileHandle, context.offlineTD);\n      alert(\"File saved\")\n    } catch (ex) {\n      const msg = \"Unfortunately we were unable to save your TD.\";\n      console.error(msg, ex);\n      alert(msg);\n    }\n  }, [context, saveFileAs, writeFile]);\n\n  const getNewFileHandle = async () => {\n    // new file system api\n    if (\"showSaveFilePicker\" in window) {\n      const opts = {\n        types: [\n          {\n            description: \"Thing Description\",\n            accept: { \"application/ld+json\": [\".jsonld\", \".json\"] },\n          },\n        ],\n      };\n\n      return await window.showSaveFilePicker(opts);\n    }\n\n    // old html file input\n    const opts = {\n      type: \"save-file\",\n      accepts: [\n        {\n          description: \"Thing Description\",\n          extensions: [\".jsonld\", \".json\"],\n          mimeTypes: [\"application/ld+json\"],\n        },\n      ],\n    };\n\n    return await window.chooseFileSystemEntries(opts);\n  };\n\n\n  useEffect(() => {\n    if (window.location.search.indexOf(\"td\") > -1) {\n      const url = new URL(window.location.href);\n      const td = url.searchParams.get(\"td\");\n      try {\n        const parsedTD = JSON.parse(td);\n        if (parsedTD[\"@type\"] === \"tm:ThingModel\") {\n          context.updateIsThingModel(true)\n        }\n        context.updateOfflineTD(JSON.stringify(parsedTD, null, 2));\n      } catch (error) {\n        alert('Sorry, we were unable to parse the TD given in the URL')\n      }\n    }\n    //because the GET Param should be only loaded once, the next line was added\n    // eslint-disable-next-line\n  }, []);\n\n  useEffect(() => {\n    const shortcutHandler = (e) => {\n      if (\n        (window.navigator.platform.match(\"Mac\") ? e.metaKey : e.ctrlKey) &&\n        e.key === \"s\"\n      ) {\n        e.preventDefault();\n        e.stopPropagation();\n        saveFile();\n      }\n      if (\n        (window.navigator.platform.match(\"Mac\") ? e.metaKey : e.ctrlKey) &&\n        e.key === \"o\"\n      ) {\n        e.preventDefault();\n        e.stopPropagation();\n        openFile();\n      }\n      if (\n        (window.navigator.platform.match(\"Mac\") ? e.metaKey : e.ctrlKey) &&\n        e.key === \"n\"\n      ) {\n        e.preventDefault();\n        e.stopPropagation();\n        openCreateTdDialog();\n      }\n    };\n\n    // Adding Eventlistener for shortcuts\n    document.addEventListener(\"keydown\", shortcutHandler, false);\n    window.onbeforeunload = function (event) {\n      var message =\n        \"Important: Please click on 'Save' button to leave this page.\";\n      if (typeof event == \"undefined\") {\n        event = window.event;\n      }\n      if (event) {\n        event.returnValue = message;\n      }\n      return message;\n    };\n    return () => {\n      //Remove Eventlistener for shortcuts before unmounting component\n      document.removeEventListener(\"keydown\", shortcutHandler, false);\n    };\n  }, [openFile, saveFile, context]);\n\n  const convertTmDialog = React.useRef();\n  const openConvertTmDialog = () => { convertTmDialog.current.openModal() }\n\n  const shareDialog = React.useRef();\n  const openShareDialog = () => { shareDialog.current.openModal() }\n\n  const createTdDialog = React.useRef();\n  const openCreateTdDialog = () => { createTdDialog.current.openModal() }\n\n  return (\n    <>\n      <header className=\"flex justify-between items-center h-16 bg-blue-500\">\n        <div className=\"flex items-center\">\n          <img className=\"pl-2 h-12\" src={wot} alt=\"WOT\" />\n          <div className=\"w-2\"></div>\n          <button>\n          <img className=\"pl-2 h-8\" src={logo} alt=\"LOGO\" onClick={() => window.open(\"https://eclipse.github.io/editdor/\",\"_blank\")}/>\n          </button>\n        </div>\n        <div className=\"flex space-x-2 pr-2\">\n          <Button onClick={openShareDialog}>Share</Button>\n          <Button onClick={openCreateTdDialog}>New</Button>\n          <Button onClick={openFile}>Open</Button>\n          {(hasNativeFS()) && <Button onClick={saveFile}>Save</Button>}\n          <Button onClick={saveFileAs}>Save As</Button>\n          {(context.showConvertBtn || context.isThingModel) && <Button onClick={openConvertTmDialog}>Convert To TD</Button>}\n        </div>\n      </header>\n      <ConvertTmDialog ref={convertTmDialog} />\n      <ShareDialog ref={shareDialog} />\n      <CreateTdDialog ref={createTdDialog} />\n      <input\n        className=\"h-0\"\n        type=\"file\"\n        id=\"fileInput\"\n        style={{ display: \"none\" }}\n      ></input>\n      <a className=\"h-0\" id=\"aDownload\" href=\"/\" style={{ display: \"none\" }}>\n        download\n      </a>\n    </>\n  );\n}\n","/********************************************************************************\n * Copyright (c) 2018 - 2021 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React, { useContext } from 'react';\nimport ediTDorContext from '../../context/ediTDorContext';\n\nconst AppFooter = (props) => {\n    const context = useContext(ediTDorContext);\n    let megaBytes = 0\n    let propertiesCount = 0\n    let actionsCount = 0\n    let eventsCount = 0\n    try {\n        const parse = JSON.parse(context.offlineTD)\n        const size = new TextEncoder().encode(JSON.stringify(parse)).length\n        megaBytes = formatByteSize(size);\n        propertiesCount = parse.properties ? Object.keys(parse.properties).length : 0\n        actionsCount = parse.properties ? Object.keys(parse.actions).length : 0\n        eventsCount = parse.properties ? Object.keys(parse.events).length : 0\n    }\n    catch (e) {\n        // console.log(e)\n    }\n    return (<>\n        <footer className=\"bg-blue-500 h-8 flex flex-col items-center justify-center text-white\">\n            <div className=\"flex flex-row items-center justify-start w-full\">\n                <div className=\"mx-2\">Properties: {propertiesCount}</div>\n                <div className=\"mx-2\">Actions: {actionsCount}</div>\n                <div className=\"mx-2\">Events: {eventsCount}</div>\n                <div className=\"mx-2 flex-grow\">Size: {megaBytes}</div>\n                <div className=\"mx-2 justify-self-end\">Version: {process.env.REACT_APP_NPM_PACKAGE_VERSION} | <u><a href=\"https://github.com/eclipse/editdor\" target=\"_blank\" rel=\"noopener noreferrer\">We are on GitHub</a></u></div>\n            </div>\n        </footer>\n    </>\n    );\n}\n\nfunction formatByteSize(bytes) {\n    if(bytes < 1024) return bytes + \" bytes\";\n    else if(bytes < 1048576) return(bytes / 1024).toFixed(3) + \" KiB\";\n    else if(bytes < 1073741824) return(bytes / 1048576).toFixed(3) + \" MiB\";\n    else return(bytes / 1073741824).toFixed(3) + \" GiB\";\n};\n\n\nexport default AppFooter","/********************************************************************************\n * Copyright (c) 2018 - 2020 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nexport const UPDATE_OFFLINE_TD = 'UPDATE_OFFLINE_TD';\nexport const UPDATE_IS_MODFIED = 'UPDATE_IS_MODFIED';\nexport const UPDATE_IS_THINGMODEL = 'UPDATE_IS_THINGMODEL';\nexport const SET_FILE_HANDLE = 'SET_FILE_HANDLE';\nexport const REMOVE_FORM_FROM_TD = 'REMOVE_FORM_FROM_TD';\nexport const REMOVE_LINK_FROM_TD = 'REMOVE_LINK_FROM_TD';\nexport const ADD_PROPERTYFORM_TO_TD = 'ADD_PROPERTYFORM_TO_TD';\nexport const ADD_ACTIONFORM_TO_TD = 'ADD_ACTIONFORM_TO_TD';\nexport const ADD_EVENTFORM_TO_TD = 'ADD_EVENTFORM_TO_TD';\nexport const REMOVE_ONE_OF_A_KIND_FROM_TD = 'REMOVE_ONE_OF_A_KIND_FROM_TD';\nexport const UPDATE_SHOW_CONVERT_BTN = 'UPDATE_SHOW_CONVERT_BTN';\nexport const ADD_LINKED_TD = 'ADD_LINKED_TD';\nexport const UPDATE_LINKED_TD = 'UPDATE_LINKED_TD'\n\nconst updateOfflineTDReducer = (offlineTD, state) => {\n  let linkedTd=state.linkedTd\n  try{\n    //If the user write Thing description without wizard, we save it in linkedTd\n    if(!linkedTd){\n      let parsedTd=JSON.parse(offlineTD)\n      linkedTd={}\n      let href=parsedTd[\"title\"]||\"ediTDor Thing\"\n      linkedTd[href]=parsedTd\n    }\n    else if(linkedTd&& typeof state.fileHandle !== \"object\"){\n      let parsedTd=JSON.parse(offlineTD)\n      if(document.getElementById(\"linkedTd\")){\n        let href= document.getElementById(\"linkedTd\").value\n        if(href===\"\"){\n        linkedTd[parsedTd[\"title\"]||\"ediTDor Thing\"]=parsedTd\n        }\n        else{\n          linkedTd[href]=parsedTd\n        }\n      }\n    }\n  }catch(e){\n    let error = e.message;\n    console.log(error)\n  }\n  return { ...state, offlineTD, isModified: true, linkedTd:linkedTd };\n};\n\nconst removeFormReducer = (form, state) => {\n  let offlineTD = JSON.parse(state.offlineTD)\n  console.log(form);\n  if (form.type === 'forms') {\n    offlineTD.forms.forEach((element, i) => {\n      if (typeof (element.op) === 'string') {\n          offlineTD.forms.splice(i, 1)\n      } else {\n        if (element.href === form.form.href && element.op.indexOf(form.form.op) !== -1) {\n          element.op.splice(element.op.indexOf(form.form.op), 1)\n        }\n        if (element.op.length === 0) {\n          offlineTD.forms.splice(i, 1)\n        }\n      }\n    });\n  } else {\n    try {\n      offlineTD[form.type][form.propName].forms.forEach((element, i) => {\n        if (typeof (element.op) === 'string') {\n          if (element.href === form.form.href) {\n            offlineTD[form.type][form.propName].forms.splice(i, 1)\n          }\n        } else {\n          if (element.href === form.form.href && element.op.indexOf(form.form.op) !== -1) {\n            element.op.splice(element.op.indexOf(form.form.op), 1)\n          }\n          if (element.op.length === 0) {\n            offlineTD[form.type][form.propName].forms.splice(i, 1)\n          }\n        }\n      });\n    } catch (e) {\n      alert('Sorry we were unable to delete the Form.');\n    }\n  }\n  return { ...state, offlineTD: JSON.stringify(offlineTD, null, 2) };\n};\n\nconst removeLinkReducer = (index, state) => {\n  let offlineTD = JSON.parse(state.offlineTD)\n    try {\n      offlineTD[\"links\"].splice(index,1)\n    } catch (e) {\n      alert('Sorry we were unable to delete the Link.');\n    }\n  let linkedTd=state.linkedTd\n  if(linkedTd&& typeof state.fileHandle !== \"object\"){\n    if(document.getElementById(\"linkedTd\")){\n      let href= document.getElementById(\"linkedTd\").value\n      if(href===\"\"){\n      linkedTd[offlineTD[\"title\"]||\"ediTDor Thing\"]=offlineTD\n      }\n      else{\n        linkedTd[href]=offlineTD\n      }\n    }\n  }\n  return { ...state, offlineTD: JSON.stringify(offlineTD, null, 2),linkedTd:linkedTd };\n};\n\nconst removeOneOfAKindReducer = (kind, oneOfAKindName, state) => {\n  let offlineTD = JSON.parse(state.offlineTD)\n  try {\n    delete offlineTD[kind][oneOfAKindName]\n  } catch (e) {\n    alert('Sorry we were unable to delete the Form.');\n  }\n  return { ...state, offlineTD: JSON.stringify(offlineTD, null, 2) };\n};\n\nconst addPropertyFormReducer = (form, state) => {\n  let offlineTD = JSON.parse(state.offlineTD)\n  const property = offlineTD.properties[form.propName];\n  if (property.forms === undefined) {\n    property.forms = []\n  }\n  property.forms.push(form.form);\n  return { ...state, offlineTD: JSON.stringify(offlineTD, null, 2) };\n};\n\nconst addLinkedTd = (td, state) =>{\n  let resultingLinkedTd ={}\n  let linkedTd= state.linkedTd\n\n  if(linkedTd === undefined){\n     resultingLinkedTd=td\n  }\n  else{\n  resultingLinkedTd = Object.assign(linkedTd, td)\n  }\n  return { ...state, linkedTd: resultingLinkedTd };\n}\n\nconst updateLinkedTd = (td, state) =>{\n  return { ...state, linkedTd: td };\n}\n\nconst addActionFormReducer = (params, state) => {\n  let offlineTD = JSON.parse(state.offlineTD)\n  const action = offlineTD.actions[params.actionName];\n  console.log('ActionForms', action.forms)\n  if (action.forms === undefined) {\n    action.forms = []\n  }\n  action.forms.push(params.form);\n  return { ...state, offlineTD: JSON.stringify(offlineTD, null, 2) };\n};\n\nconst addEventFormReducer = (params, state) => {\n  let offlineTD = JSON.parse(state.offlineTD)\n  const event = offlineTD.events[params.eventName];\n  if (event.forms === undefined) {\n    event.forms = []\n  }\n  event.forms.push(params.form);\n  return { ...state, offlineTD: JSON.stringify(offlineTD, null, 2) };\n};\n\nconst updateIsModified = (isModified, state) => {\n  return { ...state, isModified: isModified };\n};\n\nconst updateIsThingModel = (isThingModel, state) => {\n  return { ...state, isThingModel: isThingModel };\n};\n\nconst updateFileHandleReducer = (fileHandle, state) => {\n  return { ...state, fileHandle: fileHandle };\n};\n\nconst updateShowConvertBtn = (showConvertBtn, state) => {\n  return { ...state, showConvertBtn: showConvertBtn };\n};\n\nconst editdorReducer = (state, action) => {\n  switch (action.type) {\n    case UPDATE_OFFLINE_TD:\n      return updateOfflineTDReducer(action.offlineTD, state);\n    case UPDATE_IS_MODFIED:\n      return updateIsModified(action.isModified, state);\n    case UPDATE_IS_THINGMODEL:\n      return updateIsThingModel(action.isThingModel, state);\n    case SET_FILE_HANDLE:\n      const newState = updateFileHandleReducer(action.fileHandle, state)\n      return newState;\n    case REMOVE_FORM_FROM_TD:\n      return removeFormReducer(action.form, state)\n    case REMOVE_LINK_FROM_TD:\n        return removeLinkReducer(action.link, state)\n    case REMOVE_ONE_OF_A_KIND_FROM_TD:\n      return removeOneOfAKindReducer(action.kind, action.oneOfAKindName, state)\n    case ADD_PROPERTYFORM_TO_TD:\n      return addPropertyFormReducer(action.form, state)\n    case ADD_ACTIONFORM_TO_TD:\n      return addActionFormReducer(action.params, state)\n    case ADD_EVENTFORM_TO_TD:\n      return addEventFormReducer(action.params, state)\n    case UPDATE_SHOW_CONVERT_BTN:\n      return updateShowConvertBtn(action.showConvertBtn, state);\n    case ADD_LINKED_TD:\n      return addLinkedTd(action.linkedTd,state)\n    case UPDATE_LINKED_TD:\n      return updateLinkedTd(action.linkedTd,state)\n    default:\n      return state;\n  }\n};\n\nexport { editdorReducer }","/********************************************************************************\n * Copyright (c) 2018 - 2020 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React, { useReducer } from 'react';\n\nimport EdiTDorContext from './ediTDorContext';\nimport { editdorReducer, REMOVE_FORM_FROM_TD, REMOVE_LINK_FROM_TD, UPDATE_IS_THINGMODEL, SET_FILE_HANDLE, UPDATE_IS_MODFIED, UPDATE_OFFLINE_TD, ADD_PROPERTYFORM_TO_TD, ADD_ACTIONFORM_TO_TD, ADD_EVENTFORM_TO_TD, REMOVE_ONE_OF_A_KIND_FROM_TD, UPDATE_SHOW_CONVERT_BTN, ADD_LINKED_TD, UPDATE_LINKED_TD} from './editorReducers';\n\n\nconst GlobalState = props => {\n  const [editdorState, dispatch] = useReducer(editdorReducer, { offlineTD: '', theme: 'dark' });\n\n  const updateOfflineTD = (offlineTD, props) => {\n    dispatch({ type: UPDATE_OFFLINE_TD, offlineTD: offlineTD });\n  };\n\n  const updateIsModified = isModified => {\n    dispatch({ type: UPDATE_IS_MODFIED, isModified: isModified });\n  };\n\n  const updateIsThingModel = isThingModel => {\n    dispatch({ type: UPDATE_IS_THINGMODEL, isThingModel: isThingModel });\n  };\n\n  const setFileHandle = fileHandle => {\n    dispatch({ type: SET_FILE_HANDLE, fileHandle: fileHandle });\n  };\n\n  const removeForm = form => {\n    dispatch({ type: REMOVE_FORM_FROM_TD, form: form });\n  };\n\n  const removeLink = link => {\n    dispatch({ type: REMOVE_LINK_FROM_TD, link: link });\n  };\n\n  const addForm = form => {\n    dispatch({ type: ADD_PROPERTYFORM_TO_TD, form: form });\n  };\n\n  const addActionForm = params => {\n    dispatch({ type: ADD_ACTIONFORM_TO_TD, params: params });\n  };\n  const addEventForm = params => {\n    dispatch({ type: ADD_EVENTFORM_TO_TD, params: params });\n  };\n  const removeOneOfAKindReducer = (kind, oneOfAKindName) => {\n    dispatch({ type: REMOVE_ONE_OF_A_KIND_FROM_TD, kind, oneOfAKindName });\n  };\n  const updateShowConvertBtn = showConvertBtn => {\n    dispatch({ type: UPDATE_SHOW_CONVERT_BTN, showConvertBtn: showConvertBtn });\n  };\n\n  const addLinkedTd = linkedTd => {\n    dispatch({ type: ADD_LINKED_TD, linkedTd: linkedTd });\n  };\n\n  const updateLinkedTd = linkedTd => {\n    dispatch({ type: UPDATE_LINKED_TD, linkedTd: linkedTd });\n  };\n\n  return (\n    <EdiTDorContext.Provider\n      value={{\n        offlineTD: editdorState.offlineTD,\n        theme: editdorState.theme,\n        isModified: editdorState.isModified,\n        isThingModel: editdorState.isThingModel,\n        name: editdorState.name,\n        fileHandle: editdorState.fileHandle,\n        showConvertBtn: editdorState.showConvertBtn,\n        linkedTd: editdorState.linkedTd,\n        updateOfflineTD,\n        updateIsModified,\n        updateIsThingModel,\n        setFileHandle,\n        removeForm,\n        removeLink,\n        addForm,\n        addActionForm,\n        addEventForm,\n        removeOneOfAKindReducer,\n        updateShowConvertBtn,\n        addLinkedTd,\n        updateLinkedTd\n      }}\n    >\n      {props.children}\n    </EdiTDorContext.Provider>\n  );\n};\n\nexport default GlobalState;","/********************************************************************************\n * Copyright (c) 2018 - 2020 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React, { useEffect } from 'react';\nimport './App.css';\nimport TDViewer from '../TDViewer/TDViewer'\nimport JSONEditorComponent from \"../Editor/Editor\";\nimport AppHeader from './AppHeader/AppHeader';\nimport AppFooter from './AppFooter';\nimport GlobalState from '../../context/GlobalState';\n\nimport '../../assets/main.css'\n\nconst App = (props) => {\n    useEffect(() => { dragElement(document.getElementById(\"separator\"), \"H\"); }, [props])\n    return (\n        <GlobalState>\n            <main className=\"h-full w-screen flex flex-col\">\n                <AppHeader></AppHeader>\n                <div className=\"flex-grow splitter flex flex-row w-full height-adjust\">\n                    <div className=\"w-5/12\" id=\"first\"><JSONEditorComponent /></div>\n                    <div id=\"separator\"></div>\n                    <div className=\"w-7/12\" id=\"second\"><TDViewer /></div>\n                </div>\n                <AppFooter></AppFooter>\n                <div id=\"modal-root\"></div>\n            </main>\n        </GlobalState>\n    );\n}\n\n\n/**\n * \n * @param {*} element \n * @param {*} direction \n * \n * Adjust size of the two Panels \"first\" and \"second\"\n */\nconst dragElement = (element, direction) => {\n    let md;\n    const first = document.getElementById(\"first\");\n    const second = document.getElementById(\"second\");\n\n    const onMouseMove = (e) => {\n        var delta = {\n            x: e.clientX - md.e.clientX,\n            y: e.clientY - md.e.clientY\n        };\n\n        if (direction === \"H\") {\n            delta.x = Math.min(Math.max(delta.x, -md.firstWidth),\n                md.secondWidth);\n\n            element.style.left = md.offsetLeft + delta.x + \"px\";\n            first.style.width = (md.firstWidth + delta.x) + \"px\";\n            second.style.width = (md.secondWidth - delta.x) + \"px\";\n        }\n    }\n\n    const onMouseDown = (e) => {\n        md = {\n            e,\n            offsetLeft: element.offsetLeft,\n            offsetTop: element.offsetTop,\n            firstWidth: first.offsetWidth,\n            secondWidth: second.offsetWidth\n        };\n        document.onmousemove = onMouseMove;\n        document.onmouseup = () => {\n            document.onmousemove = document.onmouseup = null;\n        }\n    }\n\n    element.onmousedown = onMouseDown;\n}\n\nexport default App;","/********************************************************************************\n * Copyright (c) 2018 - 2020 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\n// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","/********************************************************************************\n * Copyright (c) 2018 - 2020 Contributors to the Eclipse Foundation\n * \n * See the NOTICE file(s) distributed with this work for additional\n * information regarding copyright ownership.\n * \n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0, or the W3C Software Notice and\n * \n * SPDX-License-Identifier: EPL-2.0 OR W3C-20150513\n ********************************************************************************/\nimport React from 'react';\nimport ReactDOM from 'react-dom'; \nimport './assets/main.css'\nimport './index.css'\nimport App from './components/App/App';\nimport * as serviceWorker from './serviceWorker';\n\nrequire('string-direction').patch();\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n\n// No PWA at the moment.\nserviceWorker.register();\n"],"sourceRoot":""}